/*!
*  filename: ej2-data.umd.min.js
*  version : 26.2.14
*  Copyright Syncfusion Inc. 2001 - 2023. All rights reserved.
*  Use of this code is subject to the terms of our license.
*  A copy of the current license can be obtained at any time by e-mailing
*  licensing@syncfusion.com. Any infringement will be prosecuted under
*  applicable laws. 
*/
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("@syncfusion/ej2-base")):"function"==typeof define&&define.amd?define(["exports","@syncfusion/ej2-base"],t):t((e=e||self).ej={},e.ej2Base)}(this,function(e,S){"use strict";Object.defineProperty(u.prototype,"moduleName",{get:function(){return"query"},enumerable:!0,configurable:!0}),u.prototype.setKey=function(e){return this.key=e,this},u.prototype.using=function(e){return this.dataManager=e,this},u.prototype.execute=function(e,t,r,n){return(e=e||this.dataManager)?e.executeQuery(this,t,r,n):A.throwError('Query - execute() : dataManager needs to be is set using "using" function or should be passed as argument')},u.prototype.executeLocal=function(e){return(e=e||this.dataManager)?e.executeLocal(this):A.throwError('Query - executeLocal() : dataManager needs to be is set using "using" function or should be passed as argument')},u.prototype.clone=function(){var e=new u;return e.queries=this.queries.slice(0),e.key=this.key,e.isChild=this.isChild,e.dataManager=this.dataManager,e.fromTable=this.fromTable,e.params=this.params.slice(0),e.expands=this.expands.slice(0),e.sortedColumns=this.sortedColumns.slice(0),e.groupedColumns=this.groupedColumns.slice(0),e.subQuerySelector=this.subQuerySelector,e.subQuery=this.subQuery,e.fKey=this.fKey,e.isCountRequired=this.isCountRequired,e.distincts=this.distincts.slice(0),e.lazyLoad=this.lazyLoad.slice(0),e},u.prototype.from=function(e){return this.fromTable=e,this},u.prototype.addParams=function(e,t){return"function"==typeof t?this.params.push({key:e,fn:t}):this.params.push({key:e,value:t}),this},u.prototype.distinct=function(e){return this.distincts="string"==typeof e?[].slice.call([e],0):e.slice(0),this},u.prototype.expand=function(e){return this.expands="string"==typeof e?[].slice.call([e],0):e.slice(0),this},u.prototype.where=function(e,t,r,n,o,a){t=t?t.toLowerCase():null;var i=null;return"string"==typeof e?i=new c(e,t,r,n,o,a):e instanceof c&&(i=e),this.queries.push({fn:"onWhere",e:i}),this},u.prototype.search=function(e,t,r,n,o){var a=A.fnOperators[r=r&&"none"!==r?r:"contains"];return this.queries.push({fn:"onSearch",e:{fieldNames:t="string"==typeof t?[t]:t,operator:r,searchKey:e,ignoreCase:n,ignoreAccent:o,comparer:a}}),this},u.prototype.sortBy=function(e,t,r){return this.sortByForeignKey(e,t,r)},u.prototype.sortByForeignKey=function(e,t,r,n){var o,n=S.isNullOrUndefined(n)?"ascending":n;if("string"==typeof e&&A.endsWith(e.toLowerCase()," desc")&&(e=e.replace(/ desc$/i,""),t="descending"),t&&"string"!=typeof t||(n=t?t.toLowerCase():"ascending",t=A.fnSort(t)),r)for(var a=u.filterQueries(this.queries,"onSortBy"),i=0;i<a.length;i++)if("string"==typeof(o=a[i].e.fieldName)){if(o===e)return this}else if(o instanceof Array)for(var s=0;s<o.length;s++)if(o[s]===e||e.toLowerCase()===o[s]+" desc")return this;return this.queries.push({fn:"onSortBy",e:{fieldName:e,comparer:t,direction:n}}),this},u.prototype.sortByDesc=function(e){return this.sortBy(e,"descending")},u.prototype.group=function(e,t,r){return this.sortBy(e,null,!0),this.queries.push({fn:"onGroup",e:{fieldName:e,comparer:t||null,format:r||null}}),this},u.prototype.page=function(e,t){return this.queries.push({fn:"onPage",e:{pageIndex:e,pageSize:t}}),this},u.prototype.range=function(e,t){return this.queries.push({fn:"onRange",e:{start:e,end:t}}),this},u.prototype.take=function(e){return this.queries.push({fn:"onTake",e:{nos:e}}),this},u.prototype.skip=function(e){return this.queries.push({fn:"onSkip",e:{nos:e}}),this},u.prototype.select=function(e){return"string"==typeof e&&(e=[].slice.call([e],0)),this.queries.push({fn:"onSelect",e:{fieldNames:e}}),this},u.prototype.hierarchy=function(e,t){return this.subQuerySelector=t,this.subQuery=e,this},u.prototype.foreignKey=function(e){return this.fKey=e,this},u.prototype.requiresCount=function(){return this.isCountRequired=!0,this},u.prototype.aggregate=function(e,t){return this.queries.push({fn:"onAggregates",e:{field:t,type:e}}),this},u.filterQueries=function(e,t){return e.filter(function(e){return e.fn===t})},u.filterQueryLists=function(e,t){for(var r=e.filter(function(e){return-1!==t.indexOf(e.fn)}),n={},o=0;o<r.length;o++)n[r[o].fn]||(n[r[o].fn]=r[o].e);return n};var b=u;function u(e){return this.subQuery=null,this.isChild=!1,this.distincts=[],this.queries=[],this.key="",this.fKey="","string"==typeof e?this.fromTable=e:e&&e instanceof Array&&(this.lookups=e),this.expands=[],this.sortedColumns=[],this.groupedColumns=[],this.subQuery=null,this.isChild=!1,this.params=[],this.lazyLoad=[],this}s.and=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return s.combinePredicates([].slice.call(e,0),"and")},s.prototype.and=function(e,t,r,n,o){return s.combine(this,e,t,r,"and",n,o)},s.or=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return s.combinePredicates([].slice.call(e,0),"or")},s.prototype.or=function(e,t,r,n,o){return s.combine(this,e,t,r,"or",n,o)},s.ornot=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return s.combinePredicates([].slice.call(e,0),"or not")},s.prototype.ornot=function(e,t,r,n,o){return s.combine(this,e,t,r,"ornot",n,o)},s.andnot=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return s.combinePredicates([].slice.call(e,0),"and not")},s.prototype.andnot=function(e,t,r,n,o){return s.combine(this,e,t,r,"andnot",n,o)},s.fromJson=function(e){if(e instanceof Array){for(var t=[],r=0,n=e.length;r<n;r++)t.push(this.fromJSONData(e[r]));return t}return this.fromJSONData(e)},s.prototype.validate=function(e){var t,r=this.predicates||[];if(!this.isComplex&&this.comparer)return this.condition&&-1!==this.condition.indexOf("not")?(this.condition=""===this.condition.split("not")[0]?void 0:this.condition.split("not")[0],!this.comparer.call(this,A.getObject(this.field,e),this.value,this.ignoreCase,this.ignoreAccent)):this.comparer.call(this,A.getObject(this.field,e),this.value,this.ignoreCase,this.ignoreAccent);for(var n=this.condition&&-1!==this.condition.indexOf("not")?-1!==this.condition.indexOf("and"):"and"===this.condition,o=0;o<r.length;o++)if(0<o&&this.condition&&-1!==this.condition.indexOf("not")&&(r[o].condition=r[o].condition?r[o].condition+"not":"not"),t=r[o].validate(e),n){if(!t)return!1}else if(t)return!0;return n},s.prototype.toJson=function(){if(this.isComplex)for(var e=[],t=this.predicates,r=0;r<t.length;r++)e.push(t[r].toJson());return{isComplex:this.isComplex,field:this.field,operator:this.operator,value:this.value,ignoreCase:this.ignoreCase,ignoreAccent:this.ignoreAccent,condition:this.condition,predicates:e,matchCase:this.matchCase}},s.combinePredicates=function(e,t){if(1===e.length){if(!(e[0]instanceof Array))return e[0];e=e[0]}return new s(e[0],t,e.slice(1))},s.combine=function(e,t,r,n,o,a,i){return t instanceof s?s[o](e,t):"string"==typeof t?s[o](e,new s(t,r,n,a,i)):A.throwError("Predicate - "+o+" : invalid arguments")},s.fromJSONData=function(e){for(var t=e.predicates||[],r=t.length,n=[],o=0;o<r;o++)n.push(this.fromJSONData(t[o]));return e.isComplex?new s(n[0],e.condition,n.slice(1)):new s(e.field,e.operator,e.value,e.ignoreCase,e.ignoreAccent)};var c=s;function s(e,t,r,n,o,a){return void 0===n&&(n=!1),this.ignoreAccent=!1,this.isComplex=!1,"string"==typeof e?(this.field=e,this.operator=t.toLowerCase(),this.value=r,this.matchCase=a,this.ignoreCase=n,this.ignoreAccent=o,this.isComplex=!1,this.comparer=A.fnOperators.processOperator(this.operator)):(e instanceof s&&r instanceof s||r instanceof Array)&&(this.isComplex=!0,this.condition=t.toLowerCase(),this.predicates=[e],this.matchCase=e.matchCase,this.ignoreCase=e.ignoreCase,this.ignoreAccent=e.ignoreAccent,r instanceof Array?[].push.apply(this.predicates,r):this.predicates.push(r)),this}var I={GroupGuid:"{271bbba0-1ee7}"},A=(f.getValue=function(e,t){return"function"==typeof e?e.call(t||{}):e},f.endsWith=function(e,t){return e.slice&&e.slice(-t.length)===t},f.notEndsWith=function(e,t){return e.slice&&e.slice(-t.length)!==t},f.startsWith=function(e,t){return e.slice(0,t.length)===t},f.notStartsWith=function(e,t){return e.slice(0,t.length)!==t},f.wildCard=function(e,t){if(-1!==(t=-1!==(t=-1!==(t=-1!==(t=-1!==t.indexOf("[")?t.split("[").join("[[]"):t).indexOf("(")?t.split("(").join("[(]"):t).indexOf(")")?t.split(")").join("[)]"):t).indexOf("\\")?t.split("\\").join("[\\\\]"):t).indexOf("*")){"*"!==(t="*"!==t.charAt(0)?"^"+t:t).charAt(t.length-1)&&(t+="$");for(var r=t.split("*"),n=0;n<r.length;n++)-1===r[n].indexOf(".")?r[n]=r[n]+".*":r[n]=r[n]+"*";t=r.join("")}return-1===t.indexOf("%3f")&&-1===t.indexOf("?")||(t=(-1!==t.indexOf("%3f")?t.split("%3f"):t.split("?")).join(".")),new RegExp(t,"g").test(e)},f.like=function(e,t){return-1!==t.indexOf("%")&&("%"===t.charAt(0)&&t.lastIndexOf("%")<2?(t=t.substring(1,t.length),f.startsWith(f.toLowerCase(e),f.toLowerCase(t))):"%"===t.charAt(t.length-1)&&t.indexOf("%")>t.length-3?(t=t.substring(0,t.length-1),f.endsWith(f.toLowerCase(e),f.toLowerCase(t))):(t.lastIndexOf("%")!==t.indexOf("%")&&t.lastIndexOf("%")>t.indexOf("%")+1&&(t=t.substring(t.indexOf("%")+1,t.lastIndexOf("%"))),-1!==e.indexOf(t)))},f.fnSort=function(e){return"ascending"===(e=e?f.toLowerCase(e):"ascending")?this.fnAscending:this.fnDescending},f.fnAscending=function(e,t){return S.isNullOrUndefined(e)&&S.isNullOrUndefined(t)||null==t?-1:"string"==typeof e?e.localeCompare(t):null==e?1:e-t},f.fnDescending=function(e,t){return S.isNullOrUndefined(e)&&S.isNullOrUndefined(t)?-1:null==t?1:"string"==typeof e?-1*e.localeCompare(t):null==e?-1:t-e},f.extractFields=function(e,t){for(var r={},n=0;n<t.length;n++)r=this.setValue(t[n],this.getObject(t[n],e),r);return r},f.select=function(e,t){for(var r=[],n=0;n<e.length;n++)r.push(this.extractFields(e[n],t));return r},f.group=function(e,n,i,t,s,o,a){t=t||1;var u=e,e="GroupGuid";if(u.GroupGuid===I[e]){for(var c=this,r=0;r<u.length;r++)!function(t){var e,r;S.isNullOrUndefined(s)?(u[t].items=c.group(u[t].items,n,i,u.level+1,null,o,a),u[t].count=u[t].items.length):(r=-1,e=s.filter(function(e){return e.key===u[t].key}),r=s.indexOf(e[0]),u[t].items=c.group(u[t].items,n,i,u.level+1,s[r].items,o,a),u[t].count=s[r].count)}(r);return u.childLevels+=1,u}for(var l={},d=[],p=(d.GroupGuid=I[e],d.level=t,d.childLevels=0,d.records=u,this),h=0;h<u.length;h++)!function(e){var t,r=p.getVal(u,e,n);S.isNullOrUndefined(o)||(r=o(r,n)),l[r]||(l[r]={key:r,count:0,items:[],aggregates:{},field:n},d.push(l[r]),S.isNullOrUndefined(s))||(t=s.filter(function(e){return e.key===l[r].key}),l[r].count=t[0].count),l[r].count=S.isNullOrUndefined(s)?l[r].count+=1:l[r].count,a&&!i.length||l[r].items.push(u[e])}(h);if(i&&i.length)for(h=0;h<d.length;h++)!function(t){for(var e={},r=void 0,n=i,o=0;o<i.length;o++){var a,r=f.aggregates[i[o].type];S.isNullOrUndefined(s)?r&&(e[n[o].field+" - "+n[o].type]=r(d[t].items,n[o].field)):(a=s.filter(function(e){return e.key===d[t].key}),r&&(e[n[o].field+" - "+n[o].type]=r(a[0].items,n[o].field)))}d[t].aggregates=e}(h);if(a&&d.length&&i.length)for(h=0;h<d.length;h++)d[h].items=[];return u.length&&d||u},f.buildHierarchy=function(e,t,r,n,o){var a,i={};for((n=n.result?n.result:n).GroupGuid&&this.throwError("DataManager: Do not have support Grouping in hierarchy"),a=0;a<n.length;a++)(i[s=this.getObject(e,n[a])]||(i[s]=[])).push(n[a]);for(a=0;a<r.length;a++){var s=this.getObject(o||e,r[a]);r[a][t]=i[s]}},f.getFieldList=function(e,t,r){if(void 0===r&&(r=""),null==t)return this.getFieldList(e,[],r);for(var n=e,o=0,a=Object.keys(e);o<a.length;o++){var i=a[o];"object"!=typeof n[i]||n[i]instanceof Array?t.push(r+i):this.getFieldList(n[i],t,r+i+".")}return t},f.getObject=function(e,t){if(!e)return t;if(t){var r,n;if(-1===e.indexOf("."))return r=e.charAt(0).toLowerCase()+e.slice(1),n=e.charAt(0).toUpperCase()+e.slice(1),S.isNullOrUndefined(t[e])?S.isNullOrUndefined(t[r])?S.isNullOrUndefined(t[n])?null:t[n]:t[r]:t[e];for(var o,a=t,i=e.split("."),s=0;s<i.length&&null!=a;s++)t=a=void 0===(a=a[i[s]])?t[o=i[s].charAt(0).toUpperCase()+i[s].slice(1)]||t[o.charAt(0).toLowerCase()+o.slice(1)]||null:a;return a}},f.setValue=function(e,t,r){for(var n,o=e.toString().split("."),e=r||{},a=e,i=o.length,s=0;s<i;s++)n=o[s],s+1===i?a[n]=void 0===t?void 0:t:S.isNullOrUndefined(a[n])&&(a[n]={}),a=a[n];return e},f.sort=function(e,t,r){var n,o;return e.length<=1?e:(n=parseInt((e.length/2).toString(),10),o=e.slice(0,n),e=e.slice(n),o=this.sort(o,t,r),e=this.sort(e,t,r),this.merge(o,e,t,r))},f.ignoreDiacritics=function(e){return"string"!=typeof e?e:e.split("").map(function(e){return e in f.diacritics?f.diacritics[e]:e}).join("")},f.merge=function(e,t,r,n){for(var o,a=[];0<e.length||0<t.length;)o=0<e.length&&0<t.length?n?n(this.getVal(e,0,r),this.getVal(t,0,r),e[0],t[0])<=0?e:t:e[0][r]<e[0][r]?e:t:0<e.length?e:t,a.push(o.shift());return a},f.getVal=function(e,t,r){return r?this.getObject(r,e[t]):e[t]},f.toLowerCase=function(e){return e?"string"==typeof e?e.toLowerCase():e.toString():0===e||!1===e?e.toString():""},f.callAdaptorFunction=function(e,t,r,n){return t in e&&(e=e[t](r,n),S.isNullOrUndefined(e)||(r=e)),r},f.getAddParams=function(e,t,r){var n={};return f.callAdaptorFunction(e,"addParams",{dm:t,query:r,params:r.params,reqParams:n}),n},f.isPlainObject=function(e){return!!e&&e.constructor===Object},f.isCors=function(){var e=null;try{e=new window.XMLHttpRequest}catch(e){}return!!e&&"withCredentials"in e},f.getGuid=function(e){var n;return(e||"")+"00000000-0000-4000-0000-000000000000".replace(/0/g,function(e,t){var r;return n="crypto"in window&&"getRandomValues"in crypto?(r=new Uint8Array(1),window.crypto.getRandomValues(r),r[0]%16|0):16*Math.random()|0,"0123456789abcdef"[19===t?3&n|8:n]})},f.isNull=function(e){return null==e},f.getItemFromComparer=function(e,t,r){var n,o,a,i=0,s="string"==typeof f.getVal(e,0,t);if(e.length)for(;S.isNullOrUndefined(n)&&i<e.length;)n=f.getVal(e,i,t),a=e[i++];for(;i<e.length;i++)o=f.getVal(e,i,t),S.isNullOrUndefined(o)||(s&&(n=+n,o=+o),0<r(n,o)&&(n=o,a=e[i]));return a},f.distinct=function(r,n,o){o=!S.isNullOrUndefined(o)&&o;var a,i=[],s={};return r.forEach(function(e,t){(a="object"==typeof r[t]?f.getVal(r,t,n):r[t])in s||(i.push(o?r[t]:a),s[a]=1)}),i},f.processData=function(e,t){var r=this.prepareQuery(e),t=new P(t),t=(e.requiresCounts&&r.requiresCount(),t.executeLocal(r)),r={result:e.requiresCounts?t.result:t,count:t.count,aggregates:JSON.stringify(t.aggregates)};return e.requiresCounts?r:t},f.prepareQuery=function(e){var r=this,n=new b;return e.select&&n.select(e.select),e.where&&f.parse.parseJson(e.where).filter(function(e){var t;S.isNullOrUndefined(e.condition)?n.where(e.field,e.operator,e.value,e.ignoreCase,e.ignoreAccent):(t=[],e.field?t.push(new c(e.field,e.operator,e.value,e.ignoreCase,e.ignoreAccent)):t=t.concat(r.getPredicate(e.predicates)),"or"===e.condition?n.where(c.or(t)):"and"===e.condition&&n.where(c.and(t)))}),e.search&&f.parse.parseJson(e.search).filter(function(e){return n.search(e.key,e.fields,e.operator,e.ignoreCase,e.ignoreAccent)}),e.aggregates&&e.aggregates.filter(function(e){return n.aggregate(e.type,e.field)}),e.sorted&&e.sorted.filter(function(e){return n.sortBy(e.name,e.direction)}),e.skip&&n.skip(e.skip),e.take&&n.take(e.take),e.group&&e.group.filter(function(e){return n.group(e)}),n},f.getPredicate=function(e){for(var t=[],r=0;r<e.length;r++){var n=e[r];if(n.field)t.push(new c(n.field,n.operator,n.value,n.ignoreCase,n.ignoreAccent));else{for(var o=[],a=this.getPredicate(n.predicates),i=0,s=Object.keys(a);i<s.length;i++){var u=s[i];o.push(a[u])}t.push("or"===n.condition?c.or(o):c.and(o))}}return t},f.serverTimezoneOffset=null,f.timeZoneHandling=!0,f.throwError=function(e){try{throw new Error(e)}catch(e){throw e.message+"\n"+e.stack}},f.aggregates={sum:function(e,t){for(var r,n=0,o="number"!=typeof f.getVal(e,0,t),a=0;a<e.length;a++)r=f.getVal(e,a,t),isNaN(r)||null===r||(n+=r=o?+r:r);return n},average:function(e,t){return f.aggregates.sum(e,t)/e.length},min:function(e,t){var r;return"function"==typeof t&&(r=t,t=null),f.getObject(t,f.getItemFromComparer(e,t,r||f.fnAscending))},max:function(e,t){var r;return"function"==typeof t&&(r=t,t=null),f.getObject(t,f.getItemFromComparer(e,t,r||f.fnDescending))},truecount:function(e,t){return new P(e).executeLocal((new b).where(t,"equal",!0,!0)).length},falsecount:function(e,t){return new P(e).executeLocal((new b).where(t,"equal",!1,!0)).length},count:function(e,t){return e.length}},f.operatorSymbols={"<":"lessthan",">":"greaterthan","<=":"lessthanorequal",">=":"greaterthanorequal","==":"equal","!=":"notequal","*=":"contains","$=":"endswith","^=":"startswith"},f.odBiOperator={"<":" lt ",">":" gt ","<=":" le ",">=":" ge ","==":" eq ","!=":" ne ",lessthan:" lt ",lessthanorequal:" le ",greaterthan:" gt ",greaterthanorequal:" ge ",equal:" eq ",notequal:" ne "},f.odUniOperator={"$=":"endswith","^=":"startswith","*=":"substringof",endswith:"endswith",startswith:"startswith",contains:"substringof",doesnotendwith:"not endswith",doesnotstartwith:"not startswith",doesnotcontain:"not substringof",wildcard:"wildcard",like:"like"},f.odv4UniOperator={"$=":"endswith","^=":"startswith","*=":"contains",endswith:"endswith",startswith:"startswith",contains:"contains",doesnotendwith:"not endswith",doesnotstartwith:"not startswith",doesnotcontain:"not contains",wildcard:"wildcard",like:"like"},f.diacritics={"Ⓐ":"A","Ａ":"A","À":"A","Á":"A","Â":"A","Ầ":"A","Ấ":"A","Ẫ":"A","Ẩ":"A","Ã":"A","Ā":"A","Ă":"A","Ằ":"A","Ắ":"A","Ẵ":"A","Ẳ":"A","Ȧ":"A","Ǡ":"A","Ä":"A","Ǟ":"A","Ả":"A","Å":"A","Ǻ":"A","Ǎ":"A","Ȁ":"A","Ȃ":"A","Ạ":"A","Ậ":"A","Ặ":"A","Ḁ":"A","Ą":"A","Ⱥ":"A","Ɐ":"A","Ꜳ":"AA","Æ":"AE","Ǽ":"AE","Ǣ":"AE","Ꜵ":"AO","Ꜷ":"AU","Ꜹ":"AV","Ꜻ":"AV","Ꜽ":"AY","Ⓑ":"B","Ｂ":"B","Ḃ":"B","Ḅ":"B","Ḇ":"B","Ƀ":"B","Ƃ":"B","Ɓ":"B","Ⓒ":"C","Ｃ":"C","Ć":"C","Ĉ":"C","Ċ":"C","Č":"C","Ç":"C","Ḉ":"C","Ƈ":"C","Ȼ":"C","Ꜿ":"C","Ⓓ":"D","Ｄ":"D","Ḋ":"D","Ď":"D","Ḍ":"D","Ḑ":"D","Ḓ":"D","Ḏ":"D","Đ":"D","Ƌ":"D","Ɗ":"D","Ɖ":"D","Ꝺ":"D","Ǳ":"DZ","Ǆ":"DZ","ǲ":"Dz","ǅ":"Dz","Ⓔ":"E","Ｅ":"E","È":"E","É":"E","Ê":"E","Ề":"E","Ế":"E","Ễ":"E","Ể":"E","Ẽ":"E","Ē":"E","Ḕ":"E","Ḗ":"E","Ĕ":"E","Ė":"E","Ë":"E","Ẻ":"E","Ě":"E","Ȅ":"E","Ȇ":"E","Ẹ":"E","Ệ":"E","Ȩ":"E","Ḝ":"E","Ę":"E","Ḙ":"E","Ḛ":"E","Ɛ":"E","Ǝ":"E","Ⓕ":"F","Ｆ":"F","Ḟ":"F","Ƒ":"F","Ꝼ":"F","Ⓖ":"G","Ｇ":"G","Ǵ":"G","Ĝ":"G","Ḡ":"G","Ğ":"G","Ġ":"G","Ǧ":"G","Ģ":"G","Ǥ":"G","Ɠ":"G","Ꞡ":"G","Ᵹ":"G","Ꝿ":"G","Ⓗ":"H","Ｈ":"H","Ĥ":"H","Ḣ":"H","Ḧ":"H","Ȟ":"H","Ḥ":"H","Ḩ":"H","Ḫ":"H","Ħ":"H","Ⱨ":"H","Ⱶ":"H","Ɥ":"H","Ⓘ":"I","Ｉ":"I","Ì":"I","Í":"I","Î":"I","Ĩ":"I","Ī":"I","Ĭ":"I","İ":"I","Ï":"I","Ḯ":"I","Ỉ":"I","Ǐ":"I","Ȉ":"I","Ȋ":"I","Ị":"I","Į":"I","Ḭ":"I","Ɨ":"I","Ⓙ":"J","Ｊ":"J","Ĵ":"J","Ɉ":"J","Ⓚ":"K","Ｋ":"K","Ḱ":"K","Ǩ":"K","Ḳ":"K","Ķ":"K","Ḵ":"K","Ƙ":"K","Ⱪ":"K","Ꝁ":"K","Ꝃ":"K","Ꝅ":"K","Ꞣ":"K","Ⓛ":"L","Ｌ":"L","Ŀ":"L","Ĺ":"L","Ľ":"L","Ḷ":"L","Ḹ":"L","Ļ":"L","Ḽ":"L","Ḻ":"L","Ł":"L","Ƚ":"L","Ɫ":"L","Ⱡ":"L","Ꝉ":"L","Ꝇ":"L","Ꞁ":"L","Ǉ":"LJ","ǈ":"Lj","Ⓜ":"M","Ｍ":"M","Ḿ":"M","Ṁ":"M","Ṃ":"M","Ɱ":"M","Ɯ":"M","Ⓝ":"N","Ｎ":"N","Ǹ":"N","Ń":"N","Ñ":"N","Ṅ":"N","Ň":"N","Ṇ":"N","Ņ":"N","Ṋ":"N","Ṉ":"N","Ƞ":"N","Ɲ":"N","Ꞑ":"N","Ꞥ":"N","Ǌ":"NJ","ǋ":"Nj","Ⓞ":"O","Ｏ":"O","Ò":"O","Ó":"O","Ô":"O","Ồ":"O","Ố":"O","Ỗ":"O","Ổ":"O","Õ":"O","Ṍ":"O","Ȭ":"O","Ṏ":"O","Ō":"O","Ṑ":"O","Ṓ":"O","Ŏ":"O","Ȯ":"O","Ȱ":"O","Ö":"O","Ȫ":"O","Ỏ":"O","Ő":"O","Ǒ":"O","Ȍ":"O","Ȏ":"O","Ơ":"O","Ờ":"O","Ớ":"O","Ỡ":"O","Ở":"O","Ợ":"O","Ọ":"O","Ộ":"O","Ǫ":"O","Ǭ":"O","Ø":"O","Ǿ":"O","Ɔ":"O","Ɵ":"O","Ꝋ":"O","Ꝍ":"O","Ƣ":"OI","Ꝏ":"OO","Ȣ":"OU","Ⓟ":"P","Ｐ":"P","Ṕ":"P","Ṗ":"P","Ƥ":"P","Ᵽ":"P","Ꝑ":"P","Ꝓ":"P","Ꝕ":"P","Ⓠ":"Q","Ｑ":"Q","Ꝗ":"Q","Ꝙ":"Q","Ɋ":"Q","Ⓡ":"R","Ｒ":"R","Ŕ":"R","Ṙ":"R","Ř":"R","Ȑ":"R","Ȓ":"R","Ṛ":"R","Ṝ":"R","Ŗ":"R","Ṟ":"R","Ɍ":"R","Ɽ":"R","Ꝛ":"R","Ꞧ":"R","Ꞃ":"R","Ⓢ":"S","Ｓ":"S","ẞ":"S","Ś":"S","Ṥ":"S","Ŝ":"S","Ṡ":"S","Š":"S","Ṧ":"S","Ṣ":"S","Ṩ":"S","Ș":"S","Ş":"S","Ȿ":"S","Ꞩ":"S","Ꞅ":"S","Ⓣ":"T","Ｔ":"T","Ṫ":"T","Ť":"T","Ṭ":"T","Ț":"T","Ţ":"T","Ṱ":"T","Ṯ":"T","Ŧ":"T","Ƭ":"T","Ʈ":"T","Ⱦ":"T","Ꞇ":"T","Ꜩ":"TZ","Ⓤ":"U","Ｕ":"U","Ù":"U","Ú":"U","Û":"U","Ũ":"U","Ṹ":"U","Ū":"U","Ṻ":"U","Ŭ":"U","Ü":"U","Ǜ":"U","Ǘ":"U","Ǖ":"U","Ǚ":"U","Ủ":"U","Ů":"U","Ű":"U","Ǔ":"U","Ȕ":"U","Ȗ":"U","Ư":"U","Ừ":"U","Ứ":"U","Ữ":"U","Ử":"U","Ự":"U","Ụ":"U","Ṳ":"U","Ų":"U","Ṷ":"U","Ṵ":"U","Ʉ":"U","Ⓥ":"V","Ｖ":"V","Ṽ":"V","Ṿ":"V","Ʋ":"V","Ꝟ":"V","Ʌ":"V","Ꝡ":"VY","Ⓦ":"W","Ｗ":"W","Ẁ":"W","Ẃ":"W","Ŵ":"W","Ẇ":"W","Ẅ":"W","Ẉ":"W","Ⱳ":"W","Ⓧ":"X","Ｘ":"X","Ẋ":"X","Ẍ":"X","Ⓨ":"Y","Ｙ":"Y","Ỳ":"Y","Ý":"Y","Ŷ":"Y","Ỹ":"Y","Ȳ":"Y","Ẏ":"Y","Ÿ":"Y","Ỷ":"Y","Ỵ":"Y","Ƴ":"Y","Ɏ":"Y","Ỿ":"Y","Ⓩ":"Z","Ｚ":"Z","Ź":"Z","Ẑ":"Z","Ż":"Z","Ž":"Z","Ẓ":"Z","Ẕ":"Z","Ƶ":"Z","Ȥ":"Z","Ɀ":"Z","Ⱬ":"Z","Ꝣ":"Z","ⓐ":"a","ａ":"a","ẚ":"a","à":"a","á":"a","â":"a","ầ":"a","ấ":"a","ẫ":"a","ẩ":"a","ã":"a","ā":"a","ă":"a","ằ":"a","ắ":"a","ẵ":"a","ẳ":"a","ȧ":"a","ǡ":"a","ä":"a","ǟ":"a","ả":"a","å":"a","ǻ":"a","ǎ":"a","ȁ":"a","ȃ":"a","ạ":"a","ậ":"a","ặ":"a","ḁ":"a","ą":"a","ⱥ":"a","ɐ":"a","ꜳ":"aa","æ":"ae","ǽ":"ae","ǣ":"ae","ꜵ":"ao","ꜷ":"au","ꜹ":"av","ꜻ":"av","ꜽ":"ay","ⓑ":"b","ｂ":"b","ḃ":"b","ḅ":"b","ḇ":"b","ƀ":"b","ƃ":"b","ɓ":"b","ⓒ":"c","ｃ":"c","ć":"c","ĉ":"c","ċ":"c","č":"c","ç":"c","ḉ":"c","ƈ":"c","ȼ":"c","ꜿ":"c","ↄ":"c","ⓓ":"d","ｄ":"d","ḋ":"d","ď":"d","ḍ":"d","ḑ":"d","ḓ":"d","ḏ":"d","đ":"d","ƌ":"d","ɖ":"d","ɗ":"d","ꝺ":"d","ǳ":"dz","ǆ":"dz","ⓔ":"e","ｅ":"e","è":"e","é":"e","ê":"e","ề":"e","ế":"e","ễ":"e","ể":"e","ẽ":"e","ē":"e","ḕ":"e","ḗ":"e","ĕ":"e","ė":"e","ë":"e","ẻ":"e","ě":"e","ȅ":"e","ȇ":"e","ẹ":"e","ệ":"e","ȩ":"e","ḝ":"e","ę":"e","ḙ":"e","ḛ":"e","ɇ":"e","ɛ":"e","ǝ":"e","ⓕ":"f","ｆ":"f","ḟ":"f","ƒ":"f","ꝼ":"f","ⓖ":"g","ｇ":"g","ǵ":"g","ĝ":"g","ḡ":"g","ğ":"g","ġ":"g","ǧ":"g","ģ":"g","ǥ":"g","ɠ":"g","ꞡ":"g","ᵹ":"g","ꝿ":"g","ⓗ":"h","ｈ":"h","ĥ":"h","ḣ":"h","ḧ":"h","ȟ":"h","ḥ":"h","ḩ":"h","ḫ":"h","ẖ":"h","ħ":"h","ⱨ":"h","ⱶ":"h","ɥ":"h","ƕ":"hv","ⓘ":"i","ｉ":"i","ì":"i","í":"i","î":"i","ĩ":"i","ī":"i","ĭ":"i","ï":"i","ḯ":"i","ỉ":"i","ǐ":"i","ȉ":"i","ȋ":"i","ị":"i","į":"i","ḭ":"i","ɨ":"i","ı":"i","ⓙ":"j","ｊ":"j","ĵ":"j","ǰ":"j","ɉ":"j","ⓚ":"k","ｋ":"k","ḱ":"k","ǩ":"k","ḳ":"k","ķ":"k","ḵ":"k","ƙ":"k","ⱪ":"k","ꝁ":"k","ꝃ":"k","ꝅ":"k","ꞣ":"k","ⓛ":"l","ｌ":"l","ŀ":"l","ĺ":"l","ľ":"l","ḷ":"l","ḹ":"l","ļ":"l","ḽ":"l","ḻ":"l","ſ":"l","ł":"l","ƚ":"l","ɫ":"l","ⱡ":"l","ꝉ":"l","ꞁ":"l","ꝇ":"l","ǉ":"lj","ⓜ":"m","ｍ":"m","ḿ":"m","ṁ":"m","ṃ":"m","ɱ":"m","ɯ":"m","ⓝ":"n","ｎ":"n","ǹ":"n","ń":"n","ñ":"n","ṅ":"n","ň":"n","ṇ":"n","ņ":"n","ṋ":"n","ṉ":"n","ƞ":"n","ɲ":"n","ŉ":"n","ꞑ":"n","ꞥ":"n","ǌ":"nj","ⓞ":"o","ｏ":"o","ò":"o","ó":"o","ô":"o","ồ":"o","ố":"o","ỗ":"o","ổ":"o","õ":"o","ṍ":"o","ȭ":"o","ṏ":"o","ō":"o","ṑ":"o","ṓ":"o","ŏ":"o","ȯ":"o","ȱ":"o","ö":"o","ȫ":"o","ỏ":"o","ő":"o","ǒ":"o","ȍ":"o","ȏ":"o","ơ":"o","ờ":"o","ớ":"o","ỡ":"o","ở":"o","ợ":"o","ọ":"o","ộ":"o","ǫ":"o","ǭ":"o","ø":"o","ǿ":"o","ɔ":"o","ꝋ":"o","ꝍ":"o","ɵ":"o","ƣ":"oi","ȣ":"ou","ꝏ":"oo","ⓟ":"p","ｐ":"p","ṕ":"p","ṗ":"p","ƥ":"p","ᵽ":"p","ꝑ":"p","ꝓ":"p","ꝕ":"p","ⓠ":"q","ｑ":"q","ɋ":"q","ꝗ":"q","ꝙ":"q","ⓡ":"r","ｒ":"r","ŕ":"r","ṙ":"r","ř":"r","ȑ":"r","ȓ":"r","ṛ":"r","ṝ":"r","ŗ":"r","ṟ":"r","ɍ":"r","ɽ":"r","ꝛ":"r","ꞧ":"r","ꞃ":"r","ⓢ":"s","ｓ":"s","ß":"s","ś":"s","ṥ":"s","ŝ":"s","ṡ":"s","š":"s","ṧ":"s","ṣ":"s","ṩ":"s","ș":"s","ş":"s","ȿ":"s","ꞩ":"s","ꞅ":"s","ẛ":"s","ⓣ":"t","ｔ":"t","ṫ":"t","ẗ":"t","ť":"t","ṭ":"t","ț":"t","ţ":"t","ṱ":"t","ṯ":"t","ŧ":"t","ƭ":"t","ʈ":"t","ⱦ":"t","ꞇ":"t","ꜩ":"tz","ⓤ":"u","ｕ":"u","ù":"u","ú":"u","û":"u","ũ":"u","ṹ":"u","ū":"u","ṻ":"u","ŭ":"u","ü":"u","ǜ":"u","ǘ":"u","ǖ":"u","ǚ":"u","ủ":"u","ů":"u","ű":"u","ǔ":"u","ȕ":"u","ȗ":"u","ư":"u","ừ":"u","ứ":"u","ữ":"u","ử":"u","ự":"u","ụ":"u","ṳ":"u","ų":"u","ṷ":"u","ṵ":"u","ʉ":"u","ⓥ":"v","ｖ":"v","ṽ":"v","ṿ":"v","ʋ":"v","ꝟ":"v","ʌ":"v","ꝡ":"vy","ⓦ":"w","ｗ":"w","ẁ":"w","ẃ":"w","ŵ":"w","ẇ":"w","ẅ":"w","ẘ":"w","ẉ":"w","ⱳ":"w","ⓧ":"x","ｘ":"x","ẋ":"x","ẍ":"x","ⓨ":"y","ｙ":"y","ỳ":"y","ý":"y","ŷ":"y","ỹ":"y","ȳ":"y","ẏ":"y","ÿ":"y","ỷ":"y","ẙ":"y","ỵ":"y","ƴ":"y","ɏ":"y","ỿ":"y","ⓩ":"z","ｚ":"z","ź":"z","ẑ":"z","ż":"z","ž":"z","ẓ":"z","ẕ":"z","ƶ":"z","ȥ":"z","ɀ":"z","ⱬ":"z","ꝣ":"z","Ά":"Α","Έ":"Ε","Ή":"Η","Ί":"Ι","Ϊ":"Ι","Ό":"Ο","Ύ":"Υ","Ϋ":"Υ","Ώ":"Ω","ά":"α","έ":"ε","ή":"η","ί":"ι","ϊ":"ι","ΐ":"ι","ό":"ο","ύ":"υ","ϋ":"υ","ΰ":"υ","ω":"ω","ς":"σ"},f.fnOperators={equal:function(e,t,r,n){return n&&(e=f.ignoreDiacritics(e),t=f.ignoreDiacritics(t)),r?f.toLowerCase(e)===f.toLowerCase(t):e===t},notequal:function(e,t,r,n){return n&&(e=f.ignoreDiacritics(e),t=f.ignoreDiacritics(t)),!f.fnOperators.equal(e,t,r)},lessthan:function(e,t,r){return r?f.toLowerCase(e)<f.toLowerCase(t):(e=S.isNullOrUndefined(e)?void 0:e)<t},greaterthan:function(e,t,r){return r?f.toLowerCase(e)>f.toLowerCase(t):t<e},lessthanorequal:function(e,t,r){return r?f.toLowerCase(e)<=f.toLowerCase(t):(e=S.isNullOrUndefined(e)?void 0:e)<=t},greaterthanorequal:function(e,t,r){return r?f.toLowerCase(e)>=f.toLowerCase(t):t<=e},contains:function(e,t,r,n){return n&&(e=f.ignoreDiacritics(e),t=f.ignoreDiacritics(t)),r?!S.isNullOrUndefined(e)&&!S.isNullOrUndefined(t)&&-1!==f.toLowerCase(e).indexOf(f.toLowerCase(t)):!S.isNullOrUndefined(e)&&!S.isNullOrUndefined(t)&&-1!==e.toString().indexOf(t)},doesnotcontain:function(e,t,r,n){return n&&(e=f.ignoreDiacritics(e),t=f.ignoreDiacritics(t)),r?!S.isNullOrUndefined(e)&&!S.isNullOrUndefined(t)&&-1===f.toLowerCase(e).indexOf(f.toLowerCase(t)):!S.isNullOrUndefined(e)&&!S.isNullOrUndefined(t)&&-1===e.toString().indexOf(t)},isnotnull:function(e){return null!=e},isnull:function(e){return null==e},startswith:function(e,t,r,n){return n&&(e=f.ignoreDiacritics(e),t=f.ignoreDiacritics(t)),r?e&&t&&f.startsWith(f.toLowerCase(e),f.toLowerCase(t)):e&&t&&f.startsWith(e,t)},doesnotstartwith:function(e,t,r,n){return n&&(e=f.ignoreDiacritics(e),t=f.ignoreDiacritics(t)),r?e&&t&&f.notStartsWith(f.toLowerCase(e),f.toLowerCase(t)):e&&t&&f.notStartsWith(e,t)},like:function(e,t,r,n){return n&&(e=f.ignoreDiacritics(e),t=f.ignoreDiacritics(t)),r?e&&t&&f.like(f.toLowerCase(e),f.toLowerCase(t)):e&&t&&f.like(e,t)},isempty:function(e){return void 0===e||""===e},isnotempty:function(e){return void 0!==e&&""!==e},wildcard:function(e,t,r,n){return n&&(e=f.ignoreDiacritics(e),t=f.ignoreDiacritics(t)),r?(e||"boolean"==typeof e)&&t&&"object"!=typeof e&&f.wildCard(f.toLowerCase(e),f.toLowerCase(t)):(e||"boolean"==typeof e)&&t&&f.wildCard(e,t)},endswith:function(e,t,r,n){return n&&(e=f.ignoreDiacritics(e),t=f.ignoreDiacritics(t)),r?e&&t&&f.endsWith(f.toLowerCase(e),f.toLowerCase(t)):e&&t&&f.endsWith(e,t)},doesnotendwith:function(e,t,r,n){return n&&(e=f.ignoreDiacritics(e),t=f.ignoreDiacritics(t)),r?e&&t&&f.notEndsWith(f.toLowerCase(e),f.toLowerCase(t)):e&&t&&f.notEndsWith(e,t)},processSymbols:function(e){e=f.operatorSymbols[e];return e?f.fnOperators[e]:f.throwError("Query - Process Operator : Invalid operator")},processOperator:function(e){var t=f.fnOperators[e];return t||f.fnOperators.processSymbols(e)}},f.parse={parseJson:function(e){return"string"!=typeof e||!/^[\s]*\[|^[\s]*\{(.)+:/g.test(e)&&-1!==e.indexOf('"')?e instanceof Array?f.parse.iterateAndReviveArray(e):"object"==typeof e&&null!==e&&f.parse.iterateAndReviveJson(e):e=JSON.parse(e,f.parse.jsonReviver),e},iterateAndReviveArray:function(e){for(var t=0;t<e.length;t++)"object"==typeof e[t]&&null!==e[t]?f.parse.iterateAndReviveJson(e[t]):"string"!=typeof e[t]||/^[\s]*\[|^[\s]*\{(.)+:|\"/g.test(e[t])&&-1!==e[t].toString().indexOf('"')?e[t]=f.parse.parseJson(e[t]):e[t]=f.parse.jsonReviver("",e[t])},iterateAndReviveJson:function(e){for(var t,r=0,n=Object.keys(e);r<n.length;r++){var o=n[r];f.startsWith(o,"__")||("object"==typeof(t=e[o])?t instanceof Array?f.parse.iterateAndReviveArray(t):t&&f.parse.iterateAndReviveJson(t):e[o]=f.parse.jsonReviver(e[o],t))}},jsonReviver:function(e,t){if("string"==typeof t){var r=/^\/Date\(([+-]?[0-9]+)([+-][0-9]{4})?\)\/$/.exec(t),n=f.timeZoneHandling?f.serverTimezoneOffset:null;if(r)return f.dateParse.toTimeZone(new Date(parseInt(r[1],10)),n,!0);if(/^(\d{4}\-\d\d\-\d\d([tT][\d:\.]*){1})([zZ]|([+\-])(\d\d):?(\d\d))?$/.test(t)){var r=-1<t.indexOf("Z")||-1<t.indexOf("z"),n=t.split(/[^0-9.]/);if(r)-1<n[5].indexOf(".")?(r=n[5].split("."),n[5]=r[0],n[6]=new Date(t).getUTCMilliseconds().toString()):n[6]="00",t=f.dateParse.toTimeZone(new Date(parseInt(n[0],10),parseInt(n[1],10)-1,parseInt(n[2],10),parseInt(n[3],10),parseInt(n[4],10),parseInt(n[5]||"00",10),parseInt(n[6],10)),f.serverTimezoneOffset,!1);else{var r=new Date(parseInt(n[0],10),parseInt(n[1],10)-1,parseInt(n[2],10),parseInt(n[3],10),parseInt(n[4],10),parseInt(n[5]||"00",10)),o=parseInt(n[6],10),n=parseInt(n[7],10);if(isNaN(o)&&isNaN(n))return r;-1<t.indexOf("+")?r.setHours(r.getHours()-o,r.getMinutes()-n):r.setHours(r.getHours()+o,r.getMinutes()+n),t=f.dateParse.toTimeZone(r,f.serverTimezoneOffset,!1)}null==f.serverTimezoneOffset&&(t=f.dateParse.addSelfOffset(t))}}return t},isJson:function(e){return"string"==typeof e[0]?e:f.parse.parseJson(e)},isGuid:function(e){return null!=/[A-Fa-f0-9]{8}(?:-[A-Fa-f0-9]{4}){3}-[A-Fa-f0-9]{12}/i.exec(e)},replacer:function(e,t){return f.isPlainObject(e)?f.parse.jsonReplacer(e,t):e instanceof Array?f.parse.arrayReplacer(e):e instanceof Date?f.parse.jsonReplacer({val:e},t).val:e},jsonReplacer:function(e,t){for(var r=0,n=Object.keys(e);r<n.length;r++){var o,a=n[r];(o=e[a])instanceof Date&&(o=o,null==f.serverTimezoneOffset?e[a]=f.dateParse.toTimeZone(o,null).toJSON():(o=new Date(+o+36e5*f.serverTimezoneOffset),e[a]=f.dateParse.toTimeZone(f.dateParse.addSelfOffset(o),null).toJSON()))}return e},arrayReplacer:function(e){for(var t=0;t<e.length;t++)f.isPlainObject(e[t])?e[t]=f.parse.jsonReplacer(e[t]):e[t]instanceof Date&&(e[t]=f.parse.jsonReplacer({date:e[t]}).date);return e},jsonDateReplacer:function(e,t){if("value"===e&&t&&("string"==typeof t&&((e=/^\/Date\(([+-]?[0-9]+)([+-][0-9]{4})?\)\/$/.exec(t))?t=f.dateParse.toTimeZone(new Date(parseInt(e[1],10)),null,!0):/^(\d{4}\-\d\d\-\d\d([tT][\d:\.]*){1})([zZ]|([+\-])(\d\d):?(\d\d))?$/.test(t)&&(e=t.split(/[^0-9]/),t=f.dateParse.toTimeZone(new Date(parseInt(e[0],10),parseInt(e[1],10)-1,parseInt(e[2],10),parseInt(e[3],10),parseInt(e[4],10),parseInt(e[5],10)),null,!0))),t instanceof Date))return t=f.dateParse.addSelfOffset(t),(null===f.serverTimezoneOffset?f.dateParse.toTimeZone(f.dateParse.addSelfOffset(t),null):t=f.dateParse.toTimeZone(t,t.getTimezoneOffset()/60-f.serverTimezoneOffset,!1)).toJSON();return t}},f.dateParse={addSelfOffset:function(e){return new Date(+e-6e4*e.getTimezoneOffset())},toUTC:function(e){return new Date(+e+6e4*e.getTimezoneOffset())},toTimeZone:function(e,t,r){return null===t?e:(r=r?f.dateParse.toUTC(e):e,new Date(+r-36e5*t))},toLocalTime:function(e){function t(e){return((e=Math.floor(Math.abs(e)))<10?"0":"")+e}var r=-e.getTimezoneOffset(),n=0<=r?"+":"-";return e.getFullYear()+"-"+t(e.getMonth()+1)+"-"+t(e.getDate())+"T"+t(e.getHours())+":"+t(e.getMinutes())+":"+t(e.getSeconds())+n+t(r/60)+":"+t(r%60)}},f);function f(){}n=function(e,t){return(n=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])}))(e,t)};var n,t=function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)},Q={GroupGuid:"{271bbba0-1ee7}"},r=(o.prototype.processResponse=function(e,t,r,n){return e},o);function o(e){this.options={from:"table",requestType:"json",sortBy:"sorted",select:"select",skip:"skip",group:"group",take:"take",search:"search",count:"requiresCounts",where:"where",aggregates:"aggregates",expand:"expand"},this.type=o,this.dataSource=e,this.pvt={}}t(l,a=r),l.prototype.processQuery=function(e,t){for(var r,n,o,a=e.dataSource.json.slice(0),i=a.length,s=!0,u={},c=0,l=[],d=[],p=0;p<t.lazyLoad.length;p++)c++,u[t.lazyLoad[p].key]=t.lazyLoad[p].value;var h={},f=!1;if(t.lazyLoad.length)for(p=0;p<t.queries.length;p++)if("onGroup"===(n=t.queries[p]).fn&&!S.isNullOrUndefined(n.e.format)){f=!0;break}for(p=0;p<t.queries.length;p++)("onPage"===(n=t.queries[p]).fn||"onGroup"===n.fn||"onSortBy"===n.fn&&!f)&&t.lazyLoad.length?("onGroup"===n.fn&&l.push(n.e),"onPage"===n.fn&&(o=n.e),"onSortBy"===n.fn&&d.unshift(n.e)):(r=this[n.fn].call(this,a,n.e,t),"onAggregates"===n.fn?h[n.e.field+" - "+n.e.type]=r:a=void 0!==r?r:a,(s="onPage"!==n.fn&&"onSkip"!==n.fn&&"onTake"!==n.fn&&"onRange"!==n.fn?s:!1)&&(i=a.length));return c&&(a=(e=this.lazyLoadGroup({query:t,lazyLoad:u,result:a,group:l,page:o,sort:d})).result,i=e.count),a=t.isCountRequired?{result:a,count:i,aggregates:h}:a},l.prototype.lazyLoadGroup=function(e){var t=0,r=this.getAggregate(e.query),n=e.result;if(S.isNullOrUndefined(e.lazyLoad.onDemandGroupInfo)){var o=e.group[0].fieldName,a=(t=(n=A.group(n,o,r,null,null,e.group[0].comparer,!0)).length,n);e.sort.length&&(u=(1<e.sort.length?e.sort.filter(function(e){return e.fieldName===o}):e.sort)[0],n=this.onSortBy(n,u,e.query,!0)),e.page&&(n=this.onPage(n,e.page,e.query)),this.formGroupResult(n,a)}else{for(var i=e.lazyLoad.onDemandGroupInfo,s=i.where.length-1;0<=s;s--)n=this.onWhere(n,i.where[s]);if(e.group.length!==i.level){var u=e.group[i.level].fieldName,n=A.group(n,u,r,null,null,e.group[i.level].comparer,!0);e.sort.length&&(n=this.onSortBy(n,e.sort[parseInt(i.level.toString(),10)],e.query,!0))}else for(s=e.sort.length-1;s>=i.level;s--)n=this.onSortBy(n,e.sort[parseInt(s.toString(),10)],e.query,!1);var t=n.length,a=n;n=(n=n.slice(i.skip)).slice(0,i.take),e.group.length!==i.level&&this.formGroupResult(n,a)}return{result:n,count:t}},l.prototype.formGroupResult=function(e,t){var r,n,o;return e.length&&t.length&&(n="childLevels",o="records",e[r="GroupGuid"]=t[r],e[n]=t[n],e.level=t.level,e[o]=t[o]),e},l.prototype.getAggregate=function(e){var t=b.filterQueries(e.queries,"onAggregates"),r=[];if(t.length)for(var n,o=0;o<t.length;o++)n=t[o].e,r.push({type:n.type,field:A.getValue(n.field,e)});return r},l.prototype.batchRequest=function(e,t,r){for(var n=t.deletedRecords.length,o=0;o<t.addedRecords.length;o++)this.insert(e,t.addedRecords[o]);for(o=0;o<t.changedRecords.length;o++)this.update(e,r.key,t.changedRecords[o]);for(o=0;o<n;o++)this.remove(e,r.key,t.deletedRecords[o]);return t},l.prototype.onWhere=function(e,t){return e&&e.length?e.filter(function(e){if(t)return t.validate(e)}):e},l.prototype.onAggregates=function(e,t){var r=A.aggregates[t.type];return e&&r&&0!==e.length?r(e,t.field):null},l.prototype.onSearch=function(e,r){return e&&e.length?(0===r.fieldNames.length&&A.getFieldList(e[0],r.fieldNames),e.filter(function(e){for(var t=0;t<r.fieldNames.length;t++)if(r.comparer.call(e,A.getObject(r.fieldNames[t],e),r.searchKey,r.ignoreCase,r.ignoreAccent))return!0;return!1})):e},l.prototype.onSortBy=function(e,t,r,n){if(!e||!e.length)return e;var o;if(!(a=A.getValue(t.fieldName,r)))return e.sort(t.comparer);if(a instanceof Array){for(var a,i=(a=a.slice(0)).length-1;0<=i;i--)a[i]&&(o=t.comparer,A.endsWith(a[i]," desc")&&(o=A.fnSort("descending"),a[i]=a[i].replace(" desc","")),e=A.sort(e,a[i],o));return e}return A.sort(e,n?"key":a,t.comparer)},l.prototype.onGroup=function(e,t,r){var n;return e&&e.length?(n=this.getAggregate(r),A.group(e,A.getValue(t.fieldName,r),n,null,null,t.comparer)):e},l.prototype.onPage=function(e,t,r){var n=A.getValue(t.pageSize,r),t=(A.getValue(t.pageIndex,r)-1)*n;return e&&e.length?e.slice(t,t+n):e},l.prototype.onRange=function(e,t){return e&&e.length?e.slice(A.getValue(t.start),A.getValue(t.end)):e},l.prototype.onTake=function(e,t){return e&&e.length?e.slice(0,A.getValue(t.nos)):e},l.prototype.onSkip=function(e,t){return e&&e.length?e.slice(A.getValue(t.nos)):e},l.prototype.onSelect=function(e,t){return e&&e.length?A.select(e,A.getValue(t.fieldNames)):e},l.prototype.insert=function(e,t,r,n,o){return S.isNullOrUndefined(o)?e.dataSource.json.push(t):e.dataSource.json.splice(o,0,t)},l.prototype.remove=function(e,t,r,n){var o,a=e.dataSource.json;for("object"!=typeof r||r instanceof Date||(r=A.getObject(t,r)),o=0;o<a.length&&A.getObject(t,a[o])!==r;o++);return o!==a.length?a.splice(o,1):null},l.prototype.update=function(e,t,r,n){var o,a,i=e.dataSource.json;for(S.isNullOrUndefined(t)||(a=S.getValue(t,r)),o=0;o<i.length&&(S.isNullOrUndefined(t)||S.getValue(t,i[o])!==a);o++);return o<i.length?S.merge(i[o],r):null};var a,i=l;function l(){return null!==a&&a.apply(this,arguments)||this}t(h,d=r),h.prototype.processQuery=function(e,t,r){var n,o,a=this.getQueryRequest(t),i=b.filterQueryLists(t.queries,["onSelect","onPage","onSkip","onTake","onRange"]),s=t.params,u=e.dataSource.url,c=null,l=this.options,d={sorts:[],groups:[],filters:[],searches:[],aggregates:[]};"onPage"in i?(n=i.onPage,o=((o=A.getValue(n.pageIndex,t))-1)*(c=A.getValue(n.pageSize,t))):"onRange"in i&&(o=(n=i.onRange).start,c=n.end-n.start);for(var p=0;p<a.sorts.length;p++)n=A.getValue(a.sorts[p].e.fieldName,t),d.sorts.push(A.callAdaptorFunction(this,"onEachSort",{name:n,direction:a.sorts[p].e.direction},t));r&&(n=this.getFiltersFrom(r,t))&&d.filters.push(A.callAdaptorFunction(this,"onEachWhere",n.toJson(),t));for(p=0;p<a.filters.length;p++){var h=A.callAdaptorFunction(this,"onEachWhere",a.filters[p].e.toJson(),t);this.getModuleName&&"ODataV4Adaptor"===this.getModuleName()&&!S.isNullOrUndefined(a.filters[p].e.key)&&1<a.filters.length&&(h="("+h+")"),d.filters.push(h);for(var f=0,g="object"==typeof d.filters[p]?Object.keys(d.filters[p]):[];f<g.length;f++){var y=g[f];A.isNull(d[y])&&delete d[y]}}for(p=0;p<a.searches.length;p++)n=a.searches[p].e,d.searches.push(A.callAdaptorFunction(this,"onEachSearch",{fields:n.fieldNames,operator:n.operator,key:n.searchKey,ignoreCase:n.ignoreCase},t));for(p=0;p<a.groups.length;p++)d.groups.push(A.getValue(a.groups[p].e.fieldName,t));for(p=0;p<a.aggregates.length;p++)n=a.aggregates[p].e,d.aggregates.push({type:n.type,field:A.getValue(n.field,t)});var m={};if(this.getRequestQuery(l,t,i,d,m),A.callAdaptorFunction(this,"addParams",{dm:e,query:t,params:s,reqParams:m}),t.lazyLoad.length)for(p=0;p<t.lazyLoad.length;p++)m[t.lazyLoad[p].key]=t.lazyLoad[p].value;for(var v=0,O=Object.keys(m);v<O.length;v++){y=O[v];!A.isNull(m[y])&&""!==m[y]&&0!==m[y].length||delete m[y]}l.skip in m&&l.take in m||null===c||(m[l.skip]=A.callAdaptorFunction(this,"onSkip",o,t),m[l.take]=A.callAdaptorFunction(this,"onTake",c,t));r=this.pvt;return this.pvt={},"json"===this.options.requestType?{data:JSON.stringify(m,A.parse.jsonDateReplacer),url:u,pvtData:r,type:"POST",contentType:"application/json; charset=utf-8"}:(n=this.convertToQueryString(m,t,e),{type:"GET",url:(n=(-1!==e.dataSource.url.indexOf("?")?"&":"/")+n).length?u.replace(/\/*$/,n):u,pvtData:r})},h.prototype.getRequestQuery=function(e,t,r,n,o){o[e.from]=t.fromTable,e.apply&&t.distincts.length&&(o[e.apply]="onDistinct"in this?A.callAdaptorFunction(this,"onDistinct",t.distincts):""),!t.distincts.length&&e.expand&&(o[e.expand]="onExpand"in this&&"onSelect"in r?A.callAdaptorFunction(this,"onExpand",{selects:A.getValue(r.onSelect.fieldNames,t),expands:t.expands},t):t.expands),o[e.select]="onSelect"in r&&!t.distincts.length?A.callAdaptorFunction(this,"onSelect",A.getValue(r.onSelect.fieldNames,t),t):"",o[e.count]=t.isCountRequired?A.callAdaptorFunction(this,"onCount",t.isCountRequired,t):"",o[e.search]=n.searches.length?A.callAdaptorFunction(this,"onSearch",n.searches,t):"",o[e.skip]="onSkip"in r?A.callAdaptorFunction(this,"onSkip",A.getValue(r.onSkip.nos,t),t):"",o[e.take]="onTake"in r?A.callAdaptorFunction(this,"onTake",A.getValue(r.onTake.nos,t),t):"",o[e.where]=n.filters.length||n.searches.length?A.callAdaptorFunction(this,"onWhere",n.filters,t):"",o[e.sortBy]=n.sorts.length?A.callAdaptorFunction(this,"onSortBy",n.sorts,t):"",o[e.group]=n.groups.length?A.callAdaptorFunction(this,"onGroup",n.groups,t):"",o[e.aggregates]=n.aggregates.length?A.callAdaptorFunction(this,"onAggregates",n.aggregates,t):"",o.param=[]},h.prototype.convertToQueryString=function(e,t,r){return""},h.prototype.processResponse=function(e,t,r,n,o,a){n&&n.headers.get("Content-Type")&&-1!==n.headers.get("Content-Type").indexOf("application/json")&&(s=A.timeZoneHandling,t&&!t.timeZoneHandling&&(A.timeZoneHandling=!1),e=A.parse.parseJson(e),A.timeZoneHandling=s);var t=o,i=t.pvtData||{},s=e?e.groupDs:[];if(n&&n.headers.get("Content-Type")&&-1!==n.headers.get("Content-Type").indexOf("xml"))return r.isCountRequired?{result:[],count:0}:[];o=JSON.parse(t.data);if(o&&"batch"===o.action&&e&&e.addedRecords)return a.addedRecords=e.addedRecords,a;var n={},u=((e=e&&e.d?e.d:e)&&"count"in e&&(n.count=e.count),n.result=e&&e.result?e.result:e,!1);if(Array.isArray(e.result)&&e.result.length)if(S.isNullOrUndefined(e.result[0].key)||(n.result=this.formRemoteGroupedData(n.result,1,i.groups.length-1)),r&&r.lazyLoad.length&&i.groups.length)for(var c,l=0;l<r.lazyLoad.length;l++)"onDemandGroupInfo"===r.lazyLoad[l].key&&(c=r.lazyLoad[l].value.level,i.groups.length===c)&&(u=!0);return u||this.getAggregateResult(i,e,n,s,r),A.isNull(n.count)?n.result:{result:n.result,count:n.count,aggregates:n.aggregates}},h.prototype.formRemoteGroupedData=function(e,t,r){for(var n=0;n<e.length;n++)e[n].items.length&&-1<Object.keys(e[n].items[0]).indexOf("key")&&this.formRemoteGroupedData(e[n].items,t+1,r-1);var o="GroupGuid",a="records";return e[o]=Q[o],e.level=t,e.childLevels=r,e[a]=e[0].items.length?this.getGroupedRecords(e,!S.isNullOrUndefined(e[0].items[a])):[],e},h.prototype.getGroupedRecords=function(e,t){for(var r=[],n=0;n<e.length;n++)if(t)r=r.concat(e[n].items.records);else for(var o=0;o<e[n].items.length;o++)r.push(e[n].items[o]);return r},h.prototype.onGroup=function(e){return this.pvt.groups=e},h.prototype.onAggregates=function(e){this.pvt.aggregates=e},h.prototype.batchRequest=function(e,t,r,n,o){return{type:"POST",url:e.dataSource.batchUrl||e.dataSource.crudUrl||e.dataSource.removeUrl||e.dataSource.url,contentType:"application/json; charset=utf-8",dataType:"json",data:JSON.stringify(S.extend({},{changed:t.changedRecords,added:t.addedRecords,deleted:t.deletedRecords,action:"batch",table:r[void 0],key:r[void 0]},A.getAddParams(this,e,n)))}},h.prototype.beforeSend=function(e,t,r){},h.prototype.insert=function(e,t,r,n){return{url:e.dataSource.insertUrl||e.dataSource.crudUrl||e.dataSource.url,data:JSON.stringify(S.extend({},{value:t,table:r,action:"insert"},A.getAddParams(this,e,n)))}},h.prototype.remove=function(e,t,r,n,o){return{type:"POST",url:e.dataSource.removeUrl||e.dataSource.crudUrl||e.dataSource.url,data:JSON.stringify(S.extend({},{key:r,keyColumn:t,table:n,action:"remove"},A.getAddParams(this,e,o)))}},h.prototype.update=function(e,t,r,n,o){return{type:"POST",url:e.dataSource.updateUrl||e.dataSource.crudUrl||e.dataSource.url,data:JSON.stringify(S.extend({},{value:r,action:"update",keyColumn:t,key:A.getObject(t,r),table:n},A.getAddParams(this,e,o)))}},h.prototype.getFiltersFrom=function(e,t){var r,n=t.fKey,o=n,a=t.key,i=[];"object"!=typeof e[0]&&(o=null);for(var s=0;s<e.length;s++)r="object"==typeof e[0]?A.getObject(a||o,e[s]):e[s],i.push(new c(n,"equal",r));return c.or(i)},h.prototype.getAggregateResult=function(e,t,r,n,o){var a=t;if(t&&t.result&&(a=t.result),e&&e.aggregates&&e.aggregates.length){var i=e.aggregates,s=void 0,u=a,c={};t.aggregate&&(u=t.aggregate);for(var l=0;l<i.length;l++)(s=A.aggregates[i[l].type])&&(c[i[l].field+" - "+i[l].type]=s(u,i[l].field));r.aggregates=c}t=Array.isArray(t.result)&&t.result.length&&!S.isNullOrUndefined(t.result[0].key);if(e&&e.groups&&e.groups.length&&!t){for(var d=e.groups,l=0;l<d.length;l++){S.isNullOrUndefined(n)||(n=A.group(n,d[l]));var p=b.filterQueries(o.queries,"onGroup")[l].e,a=A.group(a,d[l],e.aggregates,null,n,p.comparer)}r.result=a}return r},h.prototype.getQueryRequest=function(e){var t={sorts:[],groups:[],filters:[],searches:[],aggregates:[]};return t.sorts=b.filterQueries(e.queries,"onSortBy"),t.groups=b.filterQueries(e.queries,"onGroup"),t.filters=b.filterQueries(e.queries,"onWhere"),t.searches=b.filterQueries(e.queries,"onSearch"),t.aggregates=b.filterQueries(e.queries,"onAggregates"),t},h.prototype.addParams=function(e){var t=e.reqParams;e.params.length&&(t.params={});for(var r=0,n=e.params;r<n.length;r++){var o=n[r];if(t[o.key])throw new Error("Query() - addParams: Custom Param is conflicting other request arguments");t[o.key]=o.value,o.fn&&(t[o.key]=o.fn.call(e.query,o.key,e.query,e.dm)),t.params[o.key]=t[o.key]}};var d,p=h;function h(){return null!==d&&d.apply(this,arguments)||this}t(m,g=p),m.prototype.getModuleName=function(){return"ODataAdaptor"},m.prototype.onPredicate=function(e,t,r){var n,o,a="",i=e.value,s=typeof i,u=e.field?m.getField(e.field):null;if(i instanceof Date&&(i="datetime'"+A.parse.replacer(i)+"'"),"string"==s&&(i=i.replace(/'/g,"''"),e.ignoreCase&&(i=i.toLowerCase()),"like"!==e.operator&&(i=encodeURIComponent(i)),"wildcard"!==e.operator&&"like"!==e.operator&&(i="'"+i+"'"),r&&(u="cast("+u+", 'Edm.String')"),A.parse.isGuid(i)&&(o="guid"),e.ignoreCase)&&(o||(u="tolower("+u+")"),i=i.toLowerCase()),"isempty"===e.operator||"isnull"===e.operator||"isnotempty"===e.operator||"isnotnull"===e.operator?(n=-1!==e.operator.indexOf("isnot")?A.odBiOperator.notequal:A.odBiOperator.equal,i="isnull"===e.operator||"isnotnull"===e.operator?null:"''"):n=A.odBiOperator[e.operator],n)return a=a+u+n,o&&(a+=o),a+i;if("like"===(n=(S.isNullOrUndefined(this.getModuleName)||"ODataV4Adaptor"!==this.getModuleName()?A.odUniOperator:A.odv4UniOperator)[e.operator]))-1!==i.indexOf("%")&&(n="%"===i.charAt(0)&&i.lastIndexOf("%")<2?(i=i.substring(1,i.length),(S.isNullOrUndefined(this.getModuleName)||"ODataV4Adaptor"!==this.getModuleName()?A.odUniOperator:A.odv4UniOperator).startswith):"%"===i.charAt(i.length-1)&&i.indexOf("%")>i.length-3?(i=i.substring(0,i.length-1),(S.isNullOrUndefined(this.getModuleName)||"ODataV4Adaptor"!==this.getModuleName()?A.odUniOperator:A.odv4UniOperator).endswith):(i.lastIndexOf("%")!==i.indexOf("%")&&i.lastIndexOf("%")>i.indexOf("%")+1&&(i=i.substring(i.indexOf("%")+1,i.lastIndexOf("%"))),(S.isNullOrUndefined(this.getModuleName)||"ODataV4Adaptor"!==this.getModuleName()?A.odUniOperator:A.odv4UniOperator).contains)),i="'"+(i=encodeURIComponent(i))+"'";else if("wildcard"===n)if(-1!==i.indexOf("*")){var c=i.split("*"),l=void 0,d=0;if(0!==i.indexOf("*")&&-1===c[0].indexOf("%3f")&&-1===c[0].indexOf("?")&&(l="'"+(l=c[0])+"'",a=a+((n=(S.isNullOrUndefined(this.getModuleName)||"ODataV4Adaptor"!==this.getModuleName()?A.odUniOperator:A.odv4UniOperator).startswith)+"(")+u+",",o&&(a+=o),a+=l+")",d++),i.lastIndexOf("*")!==i.length-1&&-1===c[c.length-1].indexOf("%3f")&&-1===c[c.length-1].indexOf("?")&&(l="'"+(l=c[c.length-1])+"'",0<d&&(a+=" and "),a=a+((n=(S.isNullOrUndefined(this.getModuleName)||"ODataV4Adaptor"!==this.getModuleName()?A.odUniOperator:A.odv4UniOperator).endswith)+"(")+u+",",o&&(a+=o),a+=l+")",d++),2<c.length)for(var p,h=1;h<c.length-1;h++)-1===c[h].indexOf("%3f")&&-1===c[h].indexOf("?")&&(l="'"+(l=c[h])+"'",0<d&&(a+=" and "),"substringof"!==(n=(S.isNullOrUndefined(this.getModuleName)||"ODataV4Adaptor"!==this.getModuleName()?A.odUniOperator:A.odv4UniOperator).contains)&&"not substringof"!==n||(p=l,l=u,u=p),a=a+(n+"(")+u+",",o&&(a+=o),a+=l+")",d++);0===d?(n=(S.isNullOrUndefined(this.getModuleName)||"ODataV4Adaptor"!==this.getModuleName()?A.odUniOperator:A.odv4UniOperator).contains,i="'"+(i=-1===i.indexOf("?")&&-1===i.indexOf("%3f")?i:(-1!==i.indexOf("?")?i.split("?"):i.split("%3f")).join(""))+"'"):n="wildcard"}else n=(S.isNullOrUndefined(this.getModuleName)||"ODataV4Adaptor"!==this.getModuleName()?A.odUniOperator:A.odv4UniOperator).contains,i="'"+(i=-1===i.indexOf("?")&&-1===i.indexOf("%3f")?i:(-1!==i.indexOf("?")?i.split("?"):i.split("%3f")).join(""))+"'";return"substringof"!==n&&"not substringof"!==n||(p=i,i=u,u=p),"wildcard"!==n&&(a=a+(n+"(")+u+",",o&&(a+=o),a+=i+")"),a},m.prototype.addParams=function(e){g.prototype.addParams.call(this,e),delete e.reqParams.params},m.prototype.onComplexPredicate=function(e,t,r){for(var n=[],o=0;o<e.predicates.length;o++)n.push("("+this.onEachWhere(e.predicates[o],t,r)+")");return n.join(" "+e.condition+" ")},m.prototype.onEachWhere=function(e,t,r){return e.isComplex?this.onComplexPredicate(e,t,r):this.onPredicate(e,t,r)},m.prototype.onWhere=function(e){return this.pvt.search&&e.push(this.onEachWhere(this.pvt.search,null,!0)),e.join(" and ")},m.prototype.onEachSearch=function(e){e.fields&&0===e.fields.length&&A.throwError("Query() - Search : oData search requires list of field names to search");for(var t=this.pvt.search||[],r=0;r<e.fields.length;r++)t.push(new c(e.fields[r],e.operator,e.key,e.ignoreCase));this.pvt.search=t},m.prototype.onSearch=function(e){return this.pvt.search=c.or(this.pvt.search),""},m.prototype.onEachSort=function(e){var t=[];if(e.name instanceof Array)for(var r=0;r<e.name.length;r++)t.push(m.getField(e.name[r])+("descending"===e.direction?" desc":""));else t.push(m.getField(e.name)+("descending"===e.direction?" desc":""));return t.join(",")},m.prototype.onSortBy=function(e){return e.reverse().join(",")},m.prototype.onGroup=function(e){return this.pvt.groups=e,[]},m.prototype.onSelect=function(e){for(var t=0;t<e.length;t++)e[t]=m.getField(e[t]);return e.join(",")},m.prototype.onAggregates=function(e){return this.pvt.aggregates=e,""},m.prototype.onCount=function(e){return!0===e?"allpages":""},m.prototype.beforeSend=function(e,t,r){A.endsWith(r.url,this.options.batch)&&"post"===r.type.toLowerCase()?(t.headers.set("Accept",this.options.multipartAccept),t.headers.set("DataServiceVersion","2.0")):t.headers.set("Accept",this.options.accept),t.headers.set("DataServiceVersion","2.0"),t.headers.set("MaxDataServiceVersion","2.0")},m.prototype.processResponse=function(e,t,r,n,o,a){var i="odata.metadata";o&&"GET"===o.type&&!this.rootUrl&&e[i]&&(i=e[i].split("/$metadata#"),this.rootUrl=i[0],this.resourceTableName=i[1]);if(!S.isNullOrUndefined(e.d)){var s=r&&r.isCountRequired?e.d.results:e.d,u="__metadata";if(!S.isNullOrUndefined(s))for(var c=0;c<s.length;c++)S.isNullOrUndefined(s[c][u])||delete s[c][u]}var i=o&&o.pvtData,a=this.processBatchResponse(e,r,n,o,a);return a||(a=null,o=(n=n&&o.fetchRequest.headers.get("DataServiceVersion"))&&parseInt(n,10)||2,r&&r.isCountRequired&&((e[n="__count"]||e["odata.count"])&&(a=e[n]||e["odata.count"]),(e=e.d?e.d:e)[n]||e["odata.count"])&&(a=e[n]||e["odata.count"]),(e=3===o&&e.value?e.value:e).d&&(e=e.d),o<3&&e.results&&(e=e.results),(n={}).count=a,n.result=e,this.getAggregateResult(i,e,n,null,r),A.isNull(a)?n.result:{result:n.result,count:n.count,aggregates:n.aggregates})},m.prototype.convertToQueryString=function(e,t,r){var n=[],o=e.table||"";delete e.table,r.dataSource.requiresFormat&&(e.$format="json");for(var a=0,i=Object.keys(e);a<i.length;a++){var s=i[a];n.push(s+"="+e[s])}return n=n.join("&"),r.dataSource.url&&-1!==r.dataSource.url.indexOf("?")&&!o?n:n.length?o+"?"+n:o||""},m.prototype.localTimeReplacer=function(e,t){for(var r=0,n=S.isNullOrUndefined(t)?[]:Object.keys(t);r<n.length;r++){var o=n[r];t[o]instanceof Date&&(t[o]=A.dateParse.toLocalTime(t[o]))}return t},m.prototype.insert=function(e,t,r){return{url:(e.dataSource.insertUrl||e.dataSource.url).replace(/\/*$/,r?"/"+r:""),data:JSON.stringify(t,this.options.localTime?this.localTimeReplacer:null)}},m.prototype.remove=function(e,t,r,n){r="string"!=typeof r||A.parse.isGuid(r)?"("+r+")":"('"+r+"')";return{type:"DELETE",url:(e.dataSource.removeUrl||e.dataSource.url).replace(/\/*$/,n?"/"+n:"")+r}},m.prototype.update=function(e,t,r,n,o,a){a="string"!=typeof(r="PATCH"!==this.options.updateType||S.isNullOrUndefined(a)?r:this.compareAndRemove(r,a,t))[t]||A.parse.isGuid(r[t])?"("+r[t]+")":"('"+r[t]+"')";return{type:this.options.updateType,url:(e.dataSource.updateUrl||e.dataSource.url).replace(/\/*$/,n?"/"+n:"")+a,data:JSON.stringify(r,this.options.localTime?this.localTimeReplacer:null),accept:this.options.accept}},m.prototype.batchRequest=function(e,t,r,n,o){var a=r.guid=A.getGuid(this.options.batchPre),i=e.dataSource.batchUrl||this.rootUrl?(e.dataSource.batchUrl||this.rootUrl)+"/"+this.options.batch:(e.dataSource.batchUrl||e.dataSource.url).replace(/\/*$/,"/"+this.options.batch),r=(r.url=this.resourceTableName||r.url,{url:r.url,key:r.key,cid:1,cSet:A.getGuid(this.options.changeSet)}),s="--"+a+"\n";return s+="Content-Type: multipart/mixed; boundary="+r.cSet.replace("--","")+"\n",this.pvt.changeSet=0,{type:"POST",url:i,dataType:"json",contentType:"multipart/mixed; charset=UTF-8;boundary="+a,data:(s+=this.generateInsertRequest(t.addedRecords,r,e))+this.generateUpdateRequest(t.changedRecords,r,e,o?o.changedRecords:[])+this.generateDeleteRequest(t.deletedRecords,r,e)+(r.cSet+"--\n")+("--"+a+"--")}},m.prototype.generateDeleteRequest=function(e,t,r){return e?this.generateBodyContent(e,t,{method:"DELETE ",url:function(e,t,r){var n=A.getObject(r,e[t]);return"number"==typeof n||A.parse.isGuid(n)?"("+n+")":n instanceof Date?"("+e[t][r].toJSON()+")":"('"+n+"')"},data:function(e,t){return""}},r)+"\n":""},m.prototype.generateInsertRequest=function(e,t,r){return e?this.generateBodyContent(e,t,{method:"POST ",url:function(e,t,r){return""},data:function(e,t){return JSON.stringify(e[t])+"\n\n"}},r):""},m.prototype.generateUpdateRequest=function(e,r,t,n){var o,a=this;return e?(e.forEach(function(t){return t=a.compareAndRemove(t,n.filter(function(e){return A.getObject(r.key,e)===A.getObject(r.key,t)})[0],r.key)}),o={method:this.options.updateType+" ",url:function(e,t,r){return"number"==typeof e[t][r]||A.parse.isGuid(e[t][r])?"("+e[t][r]+")":e[t][r]instanceof Date?"("+e[t][r].toJSON()+")":"('"+e[t][r]+"')"},data:function(e,t){return JSON.stringify(e[t])+"\n\n"}},this.generateBodyContent(e,r,o,t)):""},m.getField=function(e){return e.replace(/\./g,"/")},m.prototype.generateBodyContent=function(e,t,r,n){for(var o="",a=0;a<e.length;a++)o=(o=(o+="\n"+t.cSet+"\n")+this.options.changeSetContent+"\n\n")+r.method,"POST "===r.method?o+=(n.dataSource.insertUrl||n.dataSource.crudUrl||t.url)+r.url(e,a,t.key)+" HTTP/1.1\n":"PUT "===r.method||"PATCH "===r.method?o+=(n.dataSource.updateUrl||n.dataSource.crudUrl||t.url)+r.url(e,a,t.key)+" HTTP/1.1\n":"DELETE "===r.method&&(o+=(n.dataSource.removeUrl||n.dataSource.crudUrl||t.url)+r.url(e,a,t.key)+" HTTP/1.1\n"),o=(o=(o+="Accept: "+this.options.accept+"\n")+"Content-Id: "+this.pvt.changeSet+++"\n")+this.options.batchChangeSetContentType+"\n",S.isNullOrUndefined(e[a]["@odata.etag"])?o+="\n":(o+="If-Match: "+e[a]["@odata.etag"]+"\n\n",delete e[a]["@odata.etag"]),o+=r.data(e,a);return o},m.prototype.processBatchResponse=function(e,t,r,n,o){if(r&&r.headers.get("Content-Type")&&-1!==r.headers.get("Content-Type").indexOf("xml"))return t.isCountRequired?{result:[],count:0}:[];if(n&&this.options.batch&&A.endsWith(n.url,this.options.batch)&&"post"===n.type.toLowerCase()){var a,i,s=e+"",t=(t=r.headers.get("Content-Type")).substring(t.indexOf("=batchresponse")+1);if((s=s.split(t)).length<2)return{};s=s[1];for(var n=/(?:\bContent-Type.+boundary=)(changesetresponse.+)/i.exec(s),e=(n&&s.replace(n[0],""),n?n[1]:""),u=(s=s.split(e)).length;-1<u;u--)/\bContent-ID:/i.test(s[u])&&/\bHTTP.+201/.test(s[u])&&(a=parseInt(/\bContent-ID: (\d+)/i.exec(s[u])[1],10),o.addedRecords[a])&&(i=A.parse.parseJson(/^\{.+\}/m.exec(s[u])[0]),S.extend({},o.addedRecords[a],this.processResponse(i)));return o}return null},m.prototype.compareAndRemove=function(t,r,n){var o=this;return S.isNullOrUndefined(r)||Object.keys(t).forEach(function(e){e!==n&&"@odata.etag"!==e&&(A.isPlainObject(t[e])?(o.compareAndRemove(t[e],r[e]),0===Object.keys(t[e]).filter(function(e){return"@odata.etag"!==e}).length&&delete t[e]):(t[e]===r[e]||t[e]&&r[e]&&t[e].valueOf()===r[e].valueOf())&&delete t[e])}),t};var g,y=m;function m(e){var t=g.call(this)||this;return t.options=S.extend({},t.options,{requestType:"get",accept:"application/json;odata=light;q=1,application/json;odata=verbose;q=0.5",multipartAccept:"multipart/mixed",sortBy:"$orderby",select:"$select",skip:"$skip",take:"$top",count:"$inlinecount",where:"$filter",expand:"$expand",batch:"$batch",changeSet:"--changeset_",batchPre:"batch_",contentId:"Content-Id: ",batchContent:"Content-Type: multipart/mixed; boundary=",changeSetContent:"Content-Type: application/http\nContent-Transfer-Encoding: binary ",batchChangeSetContentType:"Content-Type: application/json; charset=utf-8 ",updateType:"PUT"}),S.extend(t.options,e||{}),t}t(O,v=y),O.prototype.getModuleName=function(){return"ODataV4Adaptor"},O.prototype.onCount=function(e){return!0===e?"true":""},O.prototype.onPredicate=function(e,t,r){var n="",o=e.value,a=o instanceof Date;if(t instanceof b)for(var i=this.getQueryRequest(t),s=0;s<i.filters.length;s++)i.filters[s].e.key===e.value&&(r=!0);return n=v.prototype.onPredicate.call(this,e,t,r),a&&(n=n.replace(/datetime'(.*)'$/,"$1")),n=A.parse.isGuid(o)?n.replace("guid","").replace(/'/g,""):n},O.prototype.onEachSearch=function(e){var t=this.pvt.searches||[];t.push(e.key),this.pvt.searches=t},O.prototype.onSearch=function(e){return this.pvt.searches.join(" OR ")},O.prototype.onExpand=function(e){var i=this,s={},t={},r=e.expands.slice(),n=[];return e.selects.filter(function(e){return-1<e.indexOf(".")}).forEach(function(e){var t=e.split(".");if(t[0]in s||(s[t[0]]=[]),2===t.length)s[t[0]].length&&-1!==Object.keys(s).indexOf(t[0])?-1!==s[t[0]][0].indexOf("$expand")&&-1===s[t[0]][0].indexOf(";$select=")?s[t[0]][0]=s[t[0]][0]+";$select="+t[1]:s[t[0]][0]=s[t[0]][0]+","+t[1]:s[t[0]].push("$select="+t[1]);else{for(var e="$select="+t[t.length-1],r="",n="",o=1;o<t.length-1;o++)r=r+"$expand="+t[o]+"(",n+=")";var a,e=r+e+n;s[t[0]].length&&-1!==Object.keys(s).indexOf(t[0])&&i.expandQueryIndex(s[t[0]],!0)?(a=i.expandQueryIndex(s[t[0]]),s[t[0]][a]=s[t[0]][a]+e.replace("$expand=",",")):s[t[0]].push(e)}}),Object.keys(s).forEach(function(e){-1===r.indexOf(e)&&r.push(e)}),r.forEach(function(e){t[e]=e in s?e+"("+s[e].join(";")+")":e}),Object.keys(t).forEach(function(e){return n.push(t[e])}),n.join(",")},O.prototype.expandQueryIndex=function(e,t){for(var r=0;r<e.length;r++)if(-1!==e[r].indexOf("$expand"))return!!t||r;return!t&&0},O.prototype.onDistinct=function(e){return"groupby(("+e.map(function(e){return y.getField(e)}).join(",")+"))"},O.prototype.onSelect=function(e){return v.prototype.onSelect.call(this,e.filter(function(e){return-1===e.indexOf(".")}))},O.prototype.beforeSend=function(e,t,r){"POST"!==r.type&&"PUT"!==r.type&&"PATCH"!==r.type||t.headers.set("Prefer","return=representation"),t.headers.set("Accept",this.options.accept)},O.prototype.processResponse=function(e,t,r,n,o,a){var i="@odata.context",s="@context",s=(o&&"GET"===o.type&&!this.rootUrl&&(e[i]||e[s])&&(i=(e[i]||e[s]).split("/$metadata#"),this.rootUrl=i[0],this.resourceTableName=i[1]),o&&o.pvtData),i=v.prototype.processBatchResponse.call(this,e,r,n,o,a);return i||(n=null,o="@odata.count",r&&r.isCountRequired&&(o in e?n=e[o]:"@count"in e&&(n=e["@count"])),e=S.isNullOrUndefined(e.value)?e:e.value,(a={}).count=n,a.result=e,this.getAggregateResult(s,e,a,null,r),A.isNull(n)?a.result:{result:a.result,count:n,aggregates:a.aggregates})};var v,E=O;function O(e){var t=v.call(this,e)||this;return t.options=S.extend({},t.options,{requestType:"get",accept:"application/json, text/javascript, */*; q=0.01",multipartAccept:"multipart/mixed",sortBy:"$orderby",select:"$select",skip:"$skip",take:"$top",count:"$count",search:"$search",where:"$filter",expand:"$expand",batch:"$batch",changeSet:"--changeset_",batchPre:"batch_",contentId:"Content-Id: ",batchContent:"Content-Type: multipart/mixed; boundary=",changeSetContent:"Content-Type: application/http\nContent-Transfer-Encoding: binary ",batchChangeSetContentType:"Content-Type: application/json; charset=utf-8 ",updateType:"PATCH",localTime:!1,apply:"$apply"}),S.extend(t.options,e||{}),t}t(w,C=y),w.prototype.getModuleName=function(){return"WebApiAdaptor"},w.prototype.insert=function(e,t,r){return{type:"POST",url:e.dataSource.url,data:JSON.stringify(t)}},w.prototype.remove=function(e,t,r,n){return{type:"DELETE",url:e.dataSource.url+"/"+r,data:JSON.stringify(r)}},w.prototype.update=function(e,t,r,n){return{type:"PUT",url:e.dataSource.url,data:JSON.stringify(r)}},w.prototype.batchRequest=function(o,a,i){for(var s=this,u=i.guid=A.getGuid(this.options.batchPre),e=o.dataSource.url.replace(/\/*$/,"/"+this.options.batch),c=(i.url=this.resourceTableName||i.url,[]),t=0,r=a.addedRecords.length;t<r;t++)!function(n){a.addedRecords.forEach(function(e,t){var r=function(e,t,r){return""};c.push("--"+u),c.push("Content-Type: application/http; msgtype=request",""),c.push("POST /api/"+(o.dataSource.insertUrl||o.dataSource.crudUrl||i.url)+r(a.addedRecords,n,i.key)+" HTTP/1.1"),c.push("Content-Type: application/json; charset=utf-8"),c.push("Host: "+location.host),c.push("",e?JSON.stringify(e):"")})}(t);for(t=0,r=a.changedRecords.length;t<r;t++)!function(n){a.changedRecords.forEach(function(e,t){s.options.updateType;var r=function(e,t,r){return""};c.push("--"+u),c.push("Content-Type: application/http; msgtype=request",""),c.push("PUT /api/"+(o.dataSource.updateUrl||o.dataSource.crudUrl||i.url)+r(a.changedRecords,n,i.key)+" HTTP/1.1"),c.push("Content-Type: application/json; charset=utf-8"),c.push("Host: "+location.host),c.push("",e?JSON.stringify(e):"")})}(t);for(t=0,r=a.deletedRecords.length;t<r;t++)!function(n){a.deletedRecords.forEach(function(e,t){var r=function(e,t,r){var n=A.getObject(r,e[t]);return"number"==typeof n||A.parse.isGuid(n)?"/"+n:n instanceof Date?"/"+e[t][r].toJSON():"/'"+n+"'"};c.push("--"+u),c.push("Content-Type: application/http; msgtype=request",""),c.push("DELETE /api/"+(o.dataSource.removeUrl||o.dataSource.crudUrl||i.url)+r(a.deletedRecords,n,i.key)+" HTTP/1.1"),c.push("Content-Type: application/json; charset=utf-8"),c.push("Host: "+location.host),c.push("",e?JSON.stringify(e):"")})}(t);return c.push("--"+u+"--",""),{type:"POST",url:e,contentType:"multipart/mixed; boundary="+u,data:c.join("\r\n")}},w.prototype.beforeSend=function(e,t,r){t.headers.set("Accept","application/json, text/javascript, */*; q=0.01")},w.prototype.processResponse=function(e,t,r,n,o,a){var i=o&&o.pvtData,s=null,u={};return o&&"post"!==o.type.toLowerCase()&&(o=(n=n&&o.fetchRequest.headers.get("DataServiceVersion"))&&parseInt(n,10)||2,r&&r.isCountRequired&&(A.isNull(e.Count)||(s=e.Count)),o<3&&e.Items&&(e=e.Items),u.count=s,u.result=e,this.getAggregateResult(i,e,u,null,r)),u.result=u.result||e,A.isNull(s)?u.result:{result:u.result,count:u.count,aggregates:u.aggregates}};var C,J=w;function w(){return null!==C&&C.apply(this,arguments)||this}t(N,x=p),N.prototype.processQuery=function(e,t,r){var e=(new p).processQuery(e,t,r),n=A.parse.parseJson(e.data),o={};if(n.param)for(var a=0;a<n.param.length;a++){var i=n.param[a],s=Object.keys(i)[0];o[s]=i[s]}o.value=n;return{data:JSON.stringify(o,A.parse.jsonDateReplacer),url:e.url,pvtData:e.pvtData,type:"POST",contentType:"application/json; charset=utf-8"}};var x,F=N;function N(){return null!==x&&x.apply(this,arguments)||this}t(U,R=i),U.prototype.insert=function(e,t,r,n,o){return this.pvt.position=o,this.updateType="add",{url:e.dataSource.insertUrl||e.dataSource.crudUrl||e.dataSource.url,data:JSON.stringify(S.extend({},{value:t,table:r,action:"insert"},A.getAddParams(this,e,n)))}},U.prototype.remove=function(e,t,r,n,o){return R.prototype.remove.call(this,e,t,r),{type:"POST",url:e.dataSource.removeUrl||e.dataSource.crudUrl||e.dataSource.url,data:JSON.stringify(S.extend({},{key:r,keyColumn:t,table:n,action:"remove"},A.getAddParams(this,e,o)))}},U.prototype.update=function(e,t,r,n,o){return this.updateType="update",this.updateKey=t,{type:"POST",url:e.dataSource.updateUrl||e.dataSource.crudUrl||e.dataSource.url,data:JSON.stringify(S.extend({},{value:r,action:"update",keyColumn:t,key:r[t],table:n},A.getAddParams(this,e,o)))}},U.prototype.processResponse=function(e,t,r,n,o,a,i){var s;if(e="batch"===(o?JSON.parse(o.data):e).action?A.parse.parseJson(e):e,"add"===this.updateType&&R.prototype.insert.call(this,t,e,null,null,this.pvt.position),"update"===this.updateType&&R.prototype.update.call(this,t,this.updateKey,e),this.updateType=void 0,e.added)for(s=0;s<e.added.length;s++)R.prototype.insert.call(this,t,e.added[s]);if(e.changed)for(s=0;s<e.changed.length;s++)R.prototype.update.call(this,t,i.key,e.changed[s]);if(e.deleted)for(s=0;s<e.deleted.length;s++)R.prototype.remove.call(this,t,i.key,e.deleted[s]);return e},U.prototype.batchRequest=function(e,t,r,n,o){return{type:"POST",url:e.dataSource.batchUrl||e.dataSource.crudUrl||e.dataSource.url,contentType:"application/json; charset=utf-8",dataType:"json",data:JSON.stringify(S.extend({},{changed:t.changedRecords,added:t.addedRecords,deleted:t.deletedRecords,action:"batch",table:r.url,key:r.key},A.getAddParams(this,e,n)))}},U.prototype.addParams=function(e){(new p).addParams(e)};var R,G=U;function U(){var e=R.call(this)||this;return S.setValue("beforeSend",p.prototype.beforeSend,e),e}t(q,V=p),q.prototype.getModuleName=function(){return"CustomDataAdaptor"};var V,z=q;function q(e){var t=V.call(this)||this;return t.options=S.extend({},t.options,{getData:new Function,addRecord:new Function,updateRecord:new Function,deleteRecord:new Function,batchUpdate:new Function}),S.extend(t.options,e||{}),t}t(D,T=p),D.prototype.getModuleName=function(){return"GraphQLAdaptor"},D.prototype.processQuery=function(e,t){var r=T.prototype.processQuery.apply(this,arguments),n=JSON.parse(r.data),o={},a=(["skip","take","sorted","table","select","where","search","requiresCounts","aggregates","params"].filter(function(e){o[e]=-1<"searchwhereparams".indexOf(e)?JSON.stringify(n[e]):n[e]}),this.getVariables()||{}),a=(a.datamanager=o,JSON.stringify({query:this.getQuery(),variables:a}));return r.data=a,r},D.prototype.processResponse=function(e,t,r,n,o){var a,i,s=S.getValue(this.schema.result,e.data),e=(this.schema.count&&(a=S.getValue(this.schema.count,e.data)),this.schema.aggregates&&(i=S.getValue(this.schema.aggregates,e.data),i=S.isNullOrUndefined(i)?i:A.parse.parseJson(i)),o.pvtData||{}),o={result:s,aggregates:i};return e&&e.groups&&e.groups.length&&this.getAggregateResult(e,o,o,null,r),S.isNullOrUndefined(a)?o.result:{result:o.result,count:a,aggregates:i}},D.prototype.insert=function(){var e=T.prototype.insert.apply(this,arguments);return this.generateCrudData(e,"insert")},D.prototype.update=function(){var e=T.prototype.update.apply(this,arguments);return this.generateCrudData(e,"update")},D.prototype.remove=function(){var e=T.prototype.remove.apply(this,arguments);return this.generateCrudData(e,"remove")},D.prototype.batchRequest=function(e,t,r,n,o){var a=T.prototype.batchRequest.apply(this,arguments),i=JSON.parse(a.data);return i.key=r.key,a.data=JSON.stringify(i),this.generateCrudData(a,"batch")},D.prototype.generateCrudData=function(e,t){var r=JSON.parse(e.data);return e.data=JSON.stringify({query:this.opt.getMutation(t),variables:r}),e};var T,M=D;function D(e){var t=T.call(this)||this;return t.opt=e,t.schema=t.opt.response,t.query=t.opt.query,t.getVariables=t.opt.getVariables||function(){},t.getQuery=function(){return t.query},t}t(k,H=p),k.prototype.generateKey=function(e,t){var r=this.getQueryRequest(t),n=b.filterQueryLists(t.queries,["onSelect","onPage","onSkip","onTake","onRange"]),o=e;"onPage"in n&&(o+=n.onPage.pageIndex),r.sorts.forEach(function(e){o+=e.e.direction+e.e.fieldName}),r.groups.forEach(function(e){o+=e.e.fieldName}),r.searches.forEach(function(e){o+=e.e.searchKey});for(var a=0;a<r.filters.length;a++){var i=r.filters[a];if(i.e.isComplex){var s=t.clone();s.queries=[];for(var u=0;u<i.e.predicates.length;u++)s.queries.push({fn:"onWhere",e:i.e.predicates[u],filter:t.queries.filter});o+=i.e.condition+this.generateKey(e,s)}else o+=i.e.field+i.e.operator+i.e.value}return o},k.prototype.processQuery=function(e,t,r){e=this.generateKey(e.dataSource.url,t),t=A.parse.parseJson(window.localStorage.getItem(this.guidId)),t=t?t.results[t.keys.indexOf(e)]:null;return null==t||this.isCrudAction||this.isInsertAction?(this.isCrudAction=null,this.isInsertAction=null,this.cacheAdaptor.processQuery.apply(this.cacheAdaptor,[].slice.call(arguments,0))):t},k.prototype.processResponse=function(e,t,r,n,o,a){if(this.isInsertAction||o&&this.cacheAdaptor.options.batch&&A.endsWith(o.url,this.cacheAdaptor.options.batch)&&"post"===o.type.toLowerCase())return this.cacheAdaptor.processResponse(e,t,r,n,o,a);e=this.cacheAdaptor.processResponse.apply(this.cacheAdaptor,[].slice.call(arguments,0));var n=r?this.generateKey(t.dataSource.url,r):t.dataSource.url,i={},o=(i=A.parse.parseJson(window.localStorage.getItem(this.guidId))).keys.indexOf(n);for(-1!==o&&(i.results.splice(o,1),i.keys.splice(o,1)),i.results[i.keys.push(n)-1]={keys:n,result:e.result,timeStamp:new Date,count:e.count};i.results.length>this.pageSize;)i.results.splice(0,1),i.keys.splice(0,1);return window.localStorage.setItem(this.guidId,JSON.stringify(i)),e},k.prototype.beforeSend=function(e,t,r){!S.isNullOrUndefined(this.cacheAdaptor.options.batch)&&A.endsWith(r.url,this.cacheAdaptor.options.batch)&&"post"===r.type.toLowerCase()&&t.headers.set("Accept",this.cacheAdaptor.options.multipartAccept),e.dataSource.crossDomain||t.headers.set("Accept",this.cacheAdaptor.options.accept)},k.prototype.update=function(e,t,r,n){return this.isCrudAction=!0,this.cacheAdaptor.update(e,t,r,n)},k.prototype.insert=function(e,t,r){return this.isInsertAction=!0,this.cacheAdaptor.insert(e,t,r)},k.prototype.remove=function(e,t,r,n){return this.isCrudAction=!0,this.cacheAdaptor.remove(e,t,r,n)},k.prototype.batchRequest=function(e,t,r){return this.cacheAdaptor.batchRequest(e,t,r)};var H,W=k;function k(e,a,t){var r=H.call(this)||this,i=(r.isCrudAction=!1,r.isInsertAction=!1,S.isNullOrUndefined(e)||(r.cacheAdaptor=e),r.pageSize=t,r.guidId=A.getGuid("cacheAdaptor"),window.localStorage.setItem(r.guidId,JSON.stringify({keys:[],results:[]})),r.guidId);return S.isNullOrUndefined(a)||setInterval(function(){for(var e=A.parse.parseJson(window.localStorage.getItem(i)),t=[],r=0;r<e.results.length;r++){var n=+new Date,o=+new Date(e.results[r].timeStamp);e.results[r].timeStamp=n-o,a<n-o&&t.push(r)}for(r=0;r<t.length;r++)e.results.splice(t[r],1),e.keys.splice(t[r],1);window.localStorage.removeItem(i),window.localStorage.setItem(i,JSON.stringify(e))},a),r}Object.defineProperty(j.prototype,"moduleName",{get:function(){return"datamanager"},enumerable:!0,configurable:!0}),j.prototype.getPersistedData=function(e){e=localStorage.getItem(e||this.dataSource.id);return JSON.parse(e)},j.prototype.setPersistData=function(e,t,r){localStorage.setItem(t||this.dataSource.id,JSON.stringify(r||this.persistQuery))},j.prototype.setPersistQuery=function(e){var n=this,t=this.getPersistedData();return this.isInitialLoad&&t&&Object.keys(t).length?(this.persistQuery=t,this.persistQuery.queries=this.persistQuery.queries.filter(function(t){var e,r;return!(n.dataSource.ignoreOnPersist&&n.dataSource.ignoreOnPersist.length&&t.fn&&n.dataSource.ignoreOnPersist.some(function(e){return t.fn===e})||("onWhere"===t.fn&&(e=t.e)&&e.isComplex&&e.predicates instanceof Array&&(r=e.predicates.map(function(e){var t,r,n,o,a;return e.predicates&&e.predicates instanceof Array?(t=e.predicates.map(function(e){var t=e.field,r=e.operator,n=e.value,o=e.ignoreCase,a=e.ignoreAccent,e=e.matchCase;return new c(t,r,n,o,a,e)}),"and"===e.condition?c.and(t):c.or(t)):(t=e.field,r=e.operator,n=e.value,o=e.ignoreCase,a=e.ignoreAccent,e=e.matchCase,new c(t,r,n,o,a,e))}),t.e=new c(r[0],e.condition,r.slice(1))),0))}),t=S.extend(new b,this.persistQuery),this.isInitialLoad=!1,t):(this.persistQuery=e,this.isInitialLoad=!1,e)},j.prototype.setDefaultQuery=function(e){return this.defaultQuery=e,this},j.prototype.executeLocal=function(e){this.defaultQuery||e instanceof b||A.throwError("DataManager - executeLocal() : A query is required to execute"),this.dataSource.json||A.throwError("DataManager - executeLocal() : Json data is required to execute"),e=(e=this.dataSource.enablePersistence&&this.dataSource.id?this.setPersistQuery(e):e)||this.defaultQuery;var t=this.adaptor.processQuery(this,e);if(e.subQuery){var r=e.subQuery.fromTable,n=e.subQuery.lookups,o=e.isCountRequired?t.result:t;n&&n instanceof Array&&A.buildHierarchy(e.subQuery.fKey,r,o,n,e.subQuery.key);for(var a=0;a<o.length;a++)o[a][r]instanceof Array&&(o[a]=S.extend({},{},o[a]),o[a][r]=this.adaptor.processResponse(e.subQuery.using(new j(o[a][r].slice(0))).executeLocal(),this,e))}return this.adaptor.processResponse(t,this,e)},j.prototype.executeQuery=function(t,e,r,n){var o,a=this,i="makeRequest",s=("function"==typeof(t=this.dataSource.enablePersistence&&this.dataSource.id?this.setPersistQuery(t):t)&&(n=r,r=e,e=t,t=null),(t=t||this.defaultQuery)instanceof b||A.throwError("DataManager - executeQuery() : A query is required to execute"),new L),u={query:t};return!this.dataSource.offline&&void 0!==this.dataSource.url&&""!==this.dataSource.url||!S.isNullOrUndefined(this.adaptor[i])||this.isCustomDataAdaptor(this.adaptor)?(o=this.adaptor.processQuery(this,t),S.isNullOrUndefined(this.adaptor[i])?!S.isNullOrUndefined(o.url)||this.isCustomDataAdaptor(this.adaptor)?(this.requests=[],this.makeRequest(o,s,u,t)):(u=j.getDeferedArgs(t,o,u),s.resolve(u)):this.adaptor[i](o,s,u,t)):j.nextTick(function(){var e=a.executeLocal(t);u=j.getDeferedArgs(t,e,u),s.resolve(u)}),(e||r)&&s.promise.then(e,r),n&&s.promise.then(n,n),s.promise},j.getDeferedArgs=function(e,t,r){return e.isCountRequired?(r.result=t.result,r.count=t.count,r.aggregates=t.aggregates):r.result=t,r},j.nextTick=function(e){(window.setImmediate||window.setTimeout)(e,0)},j.prototype.extendRequest=function(e,t,r){return S.extend({},{type:"GET",dataType:this.dataSource.dataType,crossDomain:this.dataSource.crossDomain,jsonp:this.dataSource.jsonp,cache:!0,processData:!1,onSuccess:t,onFailure:r},e)},j.prototype.makeRequest=function(e,s,u,i){function c(t,e){var r=new L,n={parent:u},e=(i.subQuery.isChild=!0,l.adaptor.processQuery(l,i.subQuery,t?l.adaptor.processResponse(t):e)),e=l.makeRequest(e,r,n,i.subQuery);return d||r.then(function(e){t&&(A.buildHierarchy(i.subQuery.fKey,i.subQuery.fromTable,t,e,i.subQuery.key),h(t,e.count,e.xhr))},p),e}var t,r,l=this,d=!!i.subQuerySelector,p=function(e){u.error=e,s.reject(u)},h=function(e,t,r,n,o,a,i){u.xhr=r,u.count=t?parseInt(t.toString(),10):0,u.result=e,u.request=n,u.aggregates=a,u.actual=o,u.virtualSelectRecords=i,s.resolve(u)},e=this.extendRequest(e,function(e,t){if(l.isGraphQLAdaptor(l.adaptor)&&!S.isNullOrUndefined(e.errors))return p(e.errors);-1===(t=l.isCustomDataAdaptor(l.adaptor)?S.extend({},l.fetchReqOption,t):t).contentType.indexOf("xml")&&l.dateParse&&(e=A.parse.parseJson(e));var r=l.adaptor.processResponse(e,l,i,t.fetchRequest,t),n=0,o=null,a=e.virtualSelectRecords;i.isCountRequired&&(n=r.count,o=r.aggregates,r=r.result),i.subQuery?d||c(r,t):h(r,n,t.fetchRequest,t.type,e,o,a)},p);return this.isCustomDataAdaptor(this.adaptor)?(r=this.fetchReqOption=e,this.adaptor.options.getData({data:r.data,onSuccess:r.onSuccess,onFailure:r.onFailure})):((t=new S.Fetch(e)).beforeSend=function(){l.beforeSend(t.fetchRequest,t)},(e=t.send()).catch(function(e){return!0}),this.requests.push(t)),d&&((r=i.subQuerySelector.call(this,{query:i.subQuery,parent:i}))&&r.length?Promise.all([e,c(null,r)]).then(function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var r=e[0],n=l.adaptor.processResponse(r[0],l,i,l.requests[0].fetchRequest,l.requests[0]),o=0,r=(i.isCountRequired&&(o=n.count,n=n.result),l.adaptor.processResponse(r[1],l,i.subQuery,l.requests[1].fetchRequest,l.requests[1])),o=0;i.subQuery.isCountRequired&&(o=r.count,r=r.result),A.buildHierarchy(i.subQuery.fKey,i.subQuery.fromTable,n,r,i.subQuery.key),d=!1,h(n,o,l.requests[0].fetchRequest)}):d=!1),e},j.prototype.beforeSend=function(e,t){this.adaptor.beforeSend(this,e,t);for(var r=this.dataSource.headers,n=0;r&&n<r.length;n++)for(var o=[],a=0,i=Object.keys(r[n]);a<i.length;a++){var s=i[a];o.push(s),e.headers.set(s,r[n][s])}},j.prototype.saveChanges=function(r,e,t,n,o){var a,i,s=this,u=(t instanceof b&&(n=t,t=null),{url:t,key:e||this.dataSource.key}),t=this.adaptor.batchRequest(this,r,u,n||new b,o),e="dofetchRequest";return this.dataSource.offline?t:S.isNullOrUndefined(this.adaptor[e])?this.isCustomDataAdaptor(this.adaptor)?this.dofetchRequest(t,this.adaptor.options.batchUpdate):(a=new L,(i=new S.Fetch(t)).beforeSend=function(){s.beforeSend(i.fetchRequest,i)},i.onSuccess=function(e,t){s.isGraphQLAdaptor(s.adaptor)&&!S.isNullOrUndefined(e.errors)&&i.onFailure(JSON.stringify(e.errors)),a.resolve(s.adaptor.processResponse(e,s,null,t.fetchRequest,t,r,u))},i.onFailure=function(e){a.reject([{error:e}])},i.send().catch(function(e){return!0}),a.promise):this.adaptor[e](t)},j.prototype.insert=function(e,t,r,n){t instanceof b&&(r=t,t=null);e=this.adaptor.insert(this,e,t,r,n),t="dofetchRequest";return this.dataSource.offline?e:S.isNullOrUndefined(this.adaptor[t])?this.dofetchRequest(e,this.adaptor.options.addRecord):this.adaptor[t](e)},j.prototype.remove=function(e,t,r,n){"object"==typeof t&&(t=A.getObject(e,t)),r instanceof b&&(n=r,r=null);e=this.adaptor.remove(this,e,t,r,n),t="dofetchRequest";return this.dataSource.offline?e:S.isNullOrUndefined(this.adaptor[t])?(r=this.adaptor.options.deleteRecord,this.dofetchRequest(e,r)):this.adaptor[t](e)},j.prototype.update=function(e,t,r,n,o){r instanceof b&&(n=r,r=null);e=this.adaptor.update(this,e,t,r,n,o),t="dofetchRequest";return this.dataSource.offline?e:S.isNullOrUndefined(this.adaptor[t])?(r=this.adaptor.options.updateRecord,this.dofetchRequest(e,r)):this.adaptor[t](e)},j.prototype.isCustomDataAdaptor=function(e){return this.adaptor.getModuleName&&"CustomDataAdaptor"===this.adaptor.getModuleName()},j.prototype.isGraphQLAdaptor=function(e){return this.adaptor.getModuleName&&"GraphQLAdaptor"===this.adaptor.getModuleName()},j.prototype.successFunc=function(t,e){var r;this.isGraphQLAdaptor(this.adaptor)&&(r="object"==typeof t?t:JSON.parse(t),S.isNullOrUndefined(r.errors)||this.failureFunc(JSON.stringify(r.errors))),this.isCustomDataAdaptor(this.adaptor)&&(e=S.extend({},this.fetchReqOption,e));try{A.parse.parseJson(t)}catch(e){t=[]}t=this.adaptor.processResponse(A.parse.parseJson(t),this,null,e.fetchRequest,e),this.fetchDeffered.resolve(t)},j.prototype.failureFunc=function(e){this.fetchDeffered.reject([{error:e}])},j.prototype.dofetchRequest=function(e,t){var r,n=this;return e=S.extend({},{type:"POST",contentType:"application/json; charset=utf-8",processData:!1},e),this.fetchDeffered=new L,this.isCustomDataAdaptor(this.adaptor)?(this.fetchReqOption=e,t.call(this,{data:e.data,onSuccess:this.successFunc.bind(this),onFailure:this.failureFunc.bind(this)})):((r=new S.Fetch(e)).beforeSend=function(){n.beforeSend(r.fetchRequest,r)},r.onSuccess=this.successFunc.bind(this),r.onFailure=this.failureFunc.bind(this),r.send().catch(function(e){return!0})),this.fetchDeffered.promise},j.prototype.clearPersistence=function(){window.removeEventListener("unload",this.setPersistData.bind(this)),this.dataSource.enablePersistence=!1,this.persistQuery={},window.localStorage.setItem(this.dataSource.id,"[]")};var P=j;function j(e,t,r){var n,o=this;return this.dateParse=!0,this.timeZoneHandling=!0,this.persistQuery={},this.isInitialLoad=!1,this.requests=[],this.isInitialLoad=!0,e||this.dataSource||(e=[]),r=r||e.adaptor,e&&!1===e.timeZoneHandling&&(this.timeZoneHandling=e.timeZoneHandling),e instanceof Array?n={json:e,offline:!0}:"object"==typeof e?(e.json||(e.json=[]),e.enablePersistence||(e.enablePersistence=!1),e.id||(e.id=""),e.ignoreOnPersist||(e.ignoreOnPersist=[]),n={url:e.url,insertUrl:e.insertUrl,removeUrl:e.removeUrl,updateUrl:e.updateUrl,crudUrl:e.crudUrl,batchUrl:e.batchUrl,json:e.json,headers:e.headers,accept:e.accept,data:e.data,timeTillExpiration:e.timeTillExpiration,cachingPageSize:e.cachingPageSize,enableCaching:e.enableCaching,requestType:e.requestType,key:e.key,crossDomain:e.crossDomain,jsonp:e.jsonp,dataType:e.dataType,offline:void 0!==e.offline?e.offline:!(e.adaptor instanceof G||e.adaptor instanceof z||e.url),requiresFormat:e.requiresFormat,enablePersistence:e.enablePersistence,id:e.id,ignoreOnPersist:e.ignoreOnPersist}):A.throwError("DataManager: Invalid arguments"),void 0!==n.requiresFormat||A.isCors()||(n.requiresFormat=!!S.isNullOrUndefined(n.crossDomain)||n.crossDomain),void 0===n.dataType&&(n.dataType="json"),this.dataSource=n,this.defaultQuery=t,this.dataSource.enablePersistence&&this.dataSource.id&&window.addEventListener("unload",this.setPersistData.bind(this)),n.url&&n.offline&&!n.json.length?(this.isDataAvailable=!1,this.adaptor=r||new y,this.dataSource.offline=!1,this.ready=this.executeQuery(t||new b),this.ready.then(function(e){o.dataSource.offline=!0,o.isDataAvailable=!0,n.json=e.result,o.adaptor=new i})):this.adaptor=new(n.offline?i:y),!n.jsonp&&this.adaptor instanceof y&&(n.jsonp="callback"),this.adaptor=r||this.adaptor,n.enableCaching&&(this.adaptor=new W(this.adaptor,n.timeTillExpiration,n.cachingPageSize)),this}var L=function(){var r=this;this.promise=new Promise(function(e,t){r.resolve=e,r.reject=t}),this.then=this.promise.then.bind(this.promise),this.catch=this.promise.catch.bind(this.promise)};e.Adaptor=r,e.CacheAdaptor=W,e.CustomDataAdaptor=z,e.DataManager=P,e.DataUtil=A,e.Deferred=L,e.GraphQLAdaptor=M,e.JsonAdaptor=i,e.ODataAdaptor=y,e.ODataV4Adaptor=E,e.Predicate=c,e.Query=b,e.RemoteSaveAdaptor=G,e.UrlAdaptor=p,e.WebApiAdaptor=J,e.WebMethodAdaptor=F,Object.defineProperty(e,"__esModule",{value:!0})});
//# sourceMappingURL=ej2-data.umd.min.js.map
