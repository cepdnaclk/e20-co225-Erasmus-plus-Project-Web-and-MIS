/*!
*  filename: ej2-excel-export.umd.min.js
*  version : 26.2.11
*  Copyright Syncfusion Inc. 2001 - 2023. All rights reserved.
*  Use of this code is subject to the terms of our license.
*  A copy of the current license can be obtained at any time by e-mailing
*  licensing@syncfusion.com. Any infringement will be prosecuted under
*  applicable laws. 
*/
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("@syncfusion/ej2-compression"),require("@syncfusion/ej2-base"),require("@syncfusion/ej2-file-utils")):"function"==typeof define&&define.amd?define(["exports","@syncfusion/ej2-compression","@syncfusion/ej2-base","@syncfusion/ej2-file-utils"],t):t((e=e||self).ej={},e.ej2Compression,e.ej2Base,e.ej2FileUtils)}(this,function(e,a,w,z){"use strict";var h=function(){this.numFmtId=0,this.backColor="none",this.fontName="Calibri",this.fontSize=10.5,this.fontColor="#000000",this.italic=!1,this.bold=!1,this.underline=!1,this.strikeThrough=!1,this.wrapText=!1,this.hAlign="general",this.vAlign="bottom",this.indent=0,this.rotation=0,this.numberFormat="GENERAL",this.type="datetime",this.borders=new i,this.isGlobalStyle=!1},d=function(){this.sz=10.5,this.name="Calibri",this.u=!1,this.b=!1,this.i=!1,this.color="FF000000",this.strike=!1},s=function(){},l=function(){},m=function(){},p=function(){this.name="Normal",this.xfId=0},c=function(e,t){this.numFmtId=e,this.formatCode=t},t=function(e,t){this.lineStyle=e,this.color=t},i=function(){this.left=new t("none","#FFFFFF"),this.right=new t("none","#FFFFFF"),this.top=new t("none","#FFFFFF"),this.bottom=new t("none","#FFFFFF"),this.all=new t("none","#FFFFFF")};r=function(e,t){return(r=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])}))(e,t)};var r,o,u=function(){},f=(function(e,t){function o(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}(n,o=Array),n);function n(){var n=null!==o&&o.apply(this,arguments)||this;return n.add=function(e){for(var t=!1,o=0,r=0,i=n;r<i.length;r++)i[r].index===e.index&&(n[o]=e,t=!0),o++;t||n.push(e)},n}var g=function(){};v=function(e,t){return(v=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])}))(e,t)};var v,y,x=function(){},b=(function(e,t){function o(){this.constructor=e}v(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}(F,y=Array),F);function F(){var t=null!==y&&y.apply(this,arguments)||this;return t.add=function(e){t.push(e)},t}S=function(e,t){return(S=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])}))(e,t)};(function(e,t){function o(){this.constructor=e}S(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)})(L,C=Array);var S,C,k=L;function L(){return null!==C&&C.apply(this,arguments)||this}T=function(e,t){return(T=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])}))(e,t)};var T,I,_=function(){this.isSummaryRowBelow=!0,this.showGridLines=!0,this.enableRtl=!1},R=function(){},W=function(){},M=function(){},P=function(){},j=(function(e,t){function o(){this.constructor=e}T(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}(N,I=Array),N.isIntersecting=function(e,t){return e.x<=t.x+t.width&&t.x<=e.x+e.width&&e.y<=t.y+t.height&&t.y<=e.y+e.height},N);function N(){var l=null!==I&&I.apply(this,arguments)||this;return l.add=function(e){for(var t=!1,o=0,r=0,i=l;r<i.length;r++){var n,s=i[r];N.isIntersecting(s,e)&&((n=new P).x=Math.min(s.x,e.x),n.y=Math.min(s.Y,e.y),n.width=Math.max(s.Width+s.X,e.width+e.x),n.height=Math.max(s.Height+s.Y,e.height+e.y),n.ref=l[o].ref.split(":")[0]+":"+e.ref.split(":")[1],e=l[o]=n,t=!0),o++}return t||l.push(e),e},l}var G=function(){},V=(O.prototype.getFormatFunction=function(e,t){return e.type?(t&&(e.isServerRendered=!0),this.intl.getDateFormat(e)):this.intl.getNumberFormat(e)},O.prototype.toView=function(e,t){var o=e;return o=w.isNullOrUndefined(t)||w.isNullOrUndefined(e)?o:t(e)},O.prototype.displayText=function(e,t,o){return this.toView(e,this.getFormatFunction(t,o))},O);function O(e){this.intl=new w.Internationalization}A.prototype.parseWorksheet=function(e){null!==e.rows&&void 0!==e.rows&&this.parseRows(e.rows)},A.prototype.parseRows=function(e){for(var t=1,o=0,r=e;o<r.length;o++){var i=r[o];if(null===i.index||void 0===i.index)throw Error("Row index is missing.");for(;t<i.index;)this.csvStr+="\r\n",t++;this.parseRow(i)}this.csvStr+="\r\n"},A.prototype.parseRow=function(e){if(null!==e.cells&&void 0!==e.cells)for(var t=1,o=0,r=e.cells;o<r.length;o++){var i=r[o];if(null===i.index||void 0===i.index)throw Error("Cell index is missing.");for(;t<i.index;)this.csvStr+=this.separator,t++;this.parseCell(i)}},A.prototype.parseCell=function(t){var o=this.csvStr;if(void 0!==t.value)if(t.value instanceof Date)if(void 0!==t.style&&void 0!==t.style.numberFormat)try{o+=this.parseCellValue(this.formatter.displayText(t.value,{type:"dateTime",skeleton:t.style.numberFormat},this.isServerRendered))}catch(e){o+=this.parseCellValue(this.formatter.displayText(t.value,{type:"dateTime",format:t.style.numberFormat},this.isServerRendered))}else if(void 0!==t.style&&void 0!==t.style.name&&this.globalStyles.has(t.style.name))try{o+=this.parseCellValue(this.formatter.displayText(t.value,{type:"dateTime",skeleton:this.globalStyles.get(t.style.name)},this.isServerRendered))}catch(e){o+=this.parseCellValue(this.formatter.displayText(t.value,{type:"dateTime",format:this.globalStyles.get(t.style.name)},this.isServerRendered))}else o+=t.value;else"boolean"==typeof t.value?o+=t.value?"TRUE":"FALSE":"number"==typeof t.value?void 0!==t.style&&void 0!==t.style.numberFormat?o+=this.parseCellValue(this.formatter.displayText(t.value,{format:t.style.numberFormat,ignoreCurrency:!0},this.isServerRendered)):void 0!==t.style&&void 0!==t.style.name&&this.globalStyles.has(t.style.name)?o+=this.parseCellValue(this.formatter.displayText(t.value,{format:this.globalStyles.get(t.style.name),ignoreCurrency:!0},this.isServerRendered)):o+=t.value:o+=this.parseCellValue(t.value);this.csvStr=o},A.prototype.parseCellValue=function(e){for(var t="",o=e.length,r=0;r<o;r++)'"'===e[r]?t+=e[r].replace('"','""'):t+=e[r];return-1!==(e=t).indexOf(this.separator)||-1!==e.indexOf("\n")||-1!==e.indexOf('"')?'"'+e+'"':e},A.prototype.save=function(e){var t,o;this.buffer=new Blob(["\ufeff"+this.csvStr],{type:"text/csv;charset=UTF-8"}),this.isMicrosoftBrowser?navigator.msSaveBlob(this.buffer,e):(t=window.URL.createObjectURL(this.buffer),(o=document.createElementNS("http://www.w3.org/1999/xhtml","a")).download=e,o.href=t,(e=document.createEvent("MouseEvent")).initEvent("click",!0,!0),o.dispatchEvent(e),setTimeout(function(){window.URL.revokeObjectURL(t)}))},A.prototype.saveAsBlob=function(e){var t,o;return null!=e?(t=new z.Encoding,o="UTF-8",o="ANSI"==e.toUpperCase()?(t.type="Ansi","ANSI"):"UNICODE"==e.toUpperCase()?(t.type="Unicode","UNICODE"):(t.type="Utf8","UTF-8"),e=t.getBytes(this.csvStr,0,this.csvStr.length),new Blob([e],{type:"text/csv;charset="+o})):new Blob(["\ufeff"+this.csvStr],{type:"text/csv;charset=UTF-8"})};var U=A;function A(e,t){if(this.csvStr="",this.separator=null==t?",":t,this.formatter=new V,this.isMicrosoftBrowser=!!navigator.msSaveBlob,null!==e.isServerRendered&&void 0!==e.isServerRendered&&(this.isServerRendered=e.isServerRendered),null!==e.styles&&void 0!==e.styles){this.globalStyles=new Map;for(var o=0;o<e.styles.length;o++)void 0!==e.styles[o].name&&void 0!==e.styles[o].numberFormat&&this.globalStyles.set(e.styles[o].name,e.styles[o].numberFormat)}null!==e.worksheets&&void 0!==e.worksheets&&this.parseWorksheet(e.worksheets[0])}D.prototype.append=function(e){this.parts.push(e),this.blob=void 0},D.prototype.getBlob=function(){return new Blob(this.parts,{type:"text/plain"})};var B=D;function D(){this.parts=[]}var X=function(){},H=(E.prototype.parserBuiltInProperties=function(e,t){null!==e.author&&void 0!==e.author&&(t.author=e.author),null!==e.comments&&void 0!==e.comments&&(t.comments=e.comments),null!==e.category&&void 0!==e.category&&(t.category=e.category),null!==e.company&&void 0!==e.company&&(t.company=e.company),null!==e.manager&&void 0!==e.manager&&(t.manager=e.manager),null!==e.subject&&void 0!==e.subject&&(t.subject=e.subject),null!==e.title&&void 0!==e.title&&(t.title=e.title),null!==e.createdDate&&void 0!==e.createdDate&&(t.createdDate=e.createdDate),null!==e.modifiedDate&&void 0!==e.modifiedDate&&(t.modifiedDate=e.modifiedDate),null!==e.tags&&void 0!==e.tags&&(t.tags=e.tags),null!==e.status&&void 0!==e.status&&(t.status=e.status)},E.prototype.parserWorksheets=function(e){this.worksheets=new k;for(var t=e.length,o=0;o<t;o++){var r=e[o],i=new _;this.mergeCells=new j,this.mergedCellsStyle=new Map,this.mHyperLinks=[],null!==r.name&&void 0!==r.name?i.name=r.name:i.name="Sheet"+(o+1).toString(),null!==r.enableRtl&&void 0!==r.enableRtl&&(i.enableRtl=r.enableRtl),i.index=o+1,null!==r.columns&&void 0!==r.columns&&this.parserColumns(r.columns,i),null!==r.rows&&void 0!==r.rows&&this.parserRows(r.rows,i),null!==r.showGridLines&&void 0!==r.showGridLines&&(i.showGridLines=r.showGridLines),null!==r.freeze&&void 0!==r.freeze&&this.parserFreezePanes(r.freeze,i),null!==r.printTitle&&void 0!==r.printTitle&&this.parserPrintTitle(r.printTitle,i),void 0!==r.pageSetup&&void 0!==r.pageSetup.isSummaryRowBelow&&(i.isSummaryRowBelow=r.pageSetup.isSummaryRowBelow),void 0!==r.images&&this.parserImages(r.images,i),null!==r.autoFilters&&void 0!==r.autoFilters&&this.parseFilters(r.autoFilters,i),i.index=o+1,i.mergeCells=this.mergeCells,i.hyperLinks=this.mHyperLinks,this.worksheets.push(i)}},E.prototype.mergeOptions=function(e,t){var o={};return this.applyProperties(e,o),this.applyProperties(t,o),o},E.prototype.applyProperties=function(e,t){for(var o=Object.keys(e),r=0;r<o.length;r++)"name"!==o[r]&&(t[o[r]]=e[o[r]])},E.prototype.getCellName=function(e,t){return this.getColumnName(t)+e.toString()},E.prototype.getColumnName=function(e){e--;var t="";do{var o=e%26}while(e=e/26-1,t=String.fromCharCode(65+o)+t,0<=e);return t},E.prototype.parserPrintTitle=function(e,t){var o,r,i,n="";null!==e.fromRow&&void 0!==e.fromRow&&(o="$"+e.fromRow+":$"+(null!==e.toRow&&void 0!==e.toRow?e.toRow:e.fromRow)),null!==e.fromColumn&&void 0!==e.fromColumn&&(i=e.fromColumn,r=void 0,r=null!==e.toColumn&&void 0!==e.toColumn?e.toColumn:e.fromColumn,i="$"+this.getColumnName(i)+":$"+this.getColumnName(r)),void 0!==o&&(n+=t.name+"!"+o),void 0!==i&&void 0!==o?n+=","+t.name+"!"+i:void 0!==i&&(n+=t.name+"!"+i),""!==n&&this.printTitles.set(t.index-1,n)},E.prototype.parserFreezePanes=function(e,t){t.freezePanes=new M,null!==e.row&&void 0!==e.row?t.freezePanes.row=e.row:t.freezePanes.row=0,null!==e.column&&void 0!==e.column?t.freezePanes.column=e.column:t.freezePanes.column=0,t.freezePanes.leftCell=this.getCellName(t.freezePanes.row+1,t.freezePanes.column+1)},E.prototype.parserColumns=function(e,t){var o=e.length;t.columns=[];for(var r=0;r<o;r++){var i=new g;if(null===e[r].index||void 0===e[r].index)throw Error("Column index is missing.");i.index=e[r].index,null!==e[r].width&&void 0!==e[r].width&&(i.width=e[r].width),t.columns.push(i)}},E.prototype.parserRows=function(e,t){for(var o=e.length,r=(t.rows=new b,0),i=0;i<o;i++){var n=this.parserRow(e[i],r),r=n.index;t.rows.add(n)}this.insertMergedCellsStyle(t)},E.prototype.insertMergedCellsStyle=function(s){var l=this;0<this.mergeCells.length&&this.mergedCellsStyle.forEach(function(t,e){var o,r,i,n=s.rows.filter(function(e){return e.index===t.y})[0];w.isNullOrUndefined(n)?(o=s.rows.filter(function(e){return e.index<=t.y}),(r=new x).index=t.y,r.cells=new f,r.cells.add(l.createCell(t,e)),(i=0)<o.length&&(i=s.rows.indexOf(o[o.length-1])+1),s.rows.splice(i,0,r)):(o=n.cells.filter(function(e){return e.index===t.x})[0],w.isNullOrUndefined(o)?((i=0)<(r=n.cells.filter(function(e){return e.index<=t.x})).length&&(i=n.cells.indexOf(r[r.length-1])+1),n.cells.splice(i,0,l.createCell(t,e))):o.styleIndex=t.styleIndex)})},E.prototype.createCell=function(e,t){var o=new u;return o.refName=t,o.index=e.x,o.cellStyle=new h,o.styleIndex=e.styleIndex,o},E.prototype.parserRow=function(e,t){var o=new x;if(null!==e.height&&void 0!==e.height&&(o.height=e.height),null===e.index||void 0===e.index)throw Error("Row index is missing.");return o.index=e.index,null!==e.grouping&&void 0!==e.grouping&&this.parseGrouping(e.grouping,o),this.parseCells(e.cells,o),o},E.prototype.parseGrouping=function(e,t){t.grouping=new W,void 0!==e.outlineLevel&&(t.grouping.outlineLevel=e.outlineLevel),void 0!==e.isCollapsed&&(t.grouping.isCollapsed=e.isCollapsed),void 0!==e.isHidden&&(t.grouping.isHidden=e.isHidden)},E.prototype.parseCells=function(e,t){t.cells=new f;for(var o=void 0!==e?e.length:0,r=1,i=1,n=0;n<o;n++){var s,l=e[n],a=new u;if(null===l.index||void 0===l.index)throw Error("Cell index is missing.");a.index=l.index,a.index<r?r=a.index:a.index>i&&(i=a.index),a.refName=this.getCellName(t.index,a.index),null!==l.rowSpan&&void 0!==l.rowSpan?a.rowSpan=l.rowSpan-1:a.rowSpan=0,null!==l.colSpan&&void 0!==l.colSpan?a.colSpan=l.colSpan-1:a.colSpan=0,null!==l.hyperlink&&void 0!==l.hyperlink&&(s=new R,void 0!==l.hyperlink.target)&&(s.target=l.hyperlink.target,void 0!==l.hyperlink.displayText?a.value=l.hyperlink.displayText:a.value=l.hyperlink.target,a.type=this.getCellValueType(a.value),s.ref=a.refName,s.rId=this.mHyperLinks.length+1,this.mHyperLinks.push(s),a.cellStyle=new h,this.parserCellStyle(void 0!==l.style?this.mergeOptions(l.style,this.hyperlinkStyle):this.hyperlinkStyle,a.cellStyle,"string"),a.styleIndex=a.cellStyle.index),null!==l.formula&&void 0!==l.formula&&(a.formula=l.formula,a.type="formula"),null!==l.value&&void 0!==l.value&&(void 0!==a.formula?a.value=0:(a.value=l.value,a.type=this.getCellValueType(a.value))),null!==l.style&&void 0!==l.style&&void 0===a.styleIndex?(a.cellStyle=new h,a.value instanceof Date?this.parserCellStyle(l.style,a.cellStyle,a.type,14):this.parserCellStyle(l.style,a.cellStyle,a.type),a.styleIndex=a.cellStyle.index):a.value instanceof Date&&(a.cellStyle=new h,this.parserCellStyle({},a.cellStyle,a.type,14),a.styleIndex=a.cellStyle.index),this.parseCellType(a),this.mergeCells=this.processMergeCells(a,t.index,this.mergeCells),t.cells.add(a),a.index}t.spans=r+":"+i},E.prototype.GetColors=function(){var e=new Map;return e.set("WHITE","FFFFFFFF"),e.set("SILVER","FFC0C0C0"),e.set("GRAY","FF808080"),e.set("BLACK","FF000000"),e.set("RED","FFFF0000"),e.set("MAROON","FF800000"),e.set("YELLOW","FFFFFF00"),e.set("OLIVE","FF808000"),e.set("LIME","FF00FF00"),e.set("GREEN","FF008000"),e.set("AQUA","FF00FFFF"),e.set("TEAL","FF008080"),e.set("BLUE","FF0000FF"),e.set("NAVY","FF000080"),e.set("FUCHSIA","FFFF00FF"),e.set("PURPLE","FF800080"),e},E.prototype.processColor=function(e){return 0===e.indexOf("#")?e.replace("#","FF"):(e=e.toUpperCase(),this.rgbColors=this.GetColors(),this.rgbColors.has(e)?this.rgbColors.get(e):"FF000000")},E.prototype.processCellValue=function(e,t){var o=e;if(-1!==e.indexOf("<font")||-1!==e.indexOf("<a")||-1!==e.indexOf("<b>")||-1!==e.indexOf("<i>")||-1!==e.indexOf("<u>")){var r="",i=e.indexOf("<",0),n=e.indexOf(">",i+1);if(0<=i&&0<=n){for(0!==i&&(r+='<r><t xml:space="preserve">'+this.processString(e.substring(0,i))+"</t></r>");0<=i&&0<=n;)if(0<=(n=e.indexOf(">",i+1))){var s=e.substring(i+1,n),l=((i=e.indexOf("<",n+1))<0&&(i=o.length),o.substring(n+1,i));if(0!==l.length){s=s.split(" ");if(0<s.length&&(r+="<r><rPr>"),1<s.length)for(var a=0,h=s;a<h.length;a++){var d=h[a];switch(d.trim().substring(0,5)){case"size=":r+='<sz val="'+d.substring(6,d.length-1)+'"/>';break;case"face=":r+='<rFont val="'+d.substring(6,d.length-1)+'"/>';break;case"color":r+='<color rgb="'+this.processColor(d.substring(7,d.length-1))+'"/>';break;case"href=":var m=new R;m.target=d.substring(6,d.length-1).trim(),m.ref=t.refName,m.rId=this.mHyperLinks.length+1,this.mHyperLinks.push(m),r+='<color rgb="FF0000FF"/><u/><b/>'}}else if(1===s.length)switch(s[0].trim()){case"b":r+="<b/>";break;case"i":r+="<i/>";break;case"u":r+="<u/>"}r+='</rPr><t xml:space="preserve">'+this.processString(l)+"</t></r>"}}return""===r?o:r}}return o},E.prototype.applyGlobalStyle=function(t,e){this.cellStyles.has(t.name)&&(e.index=this.mStyles.filter(function(e){return e.name===t.name})[0].index,e.name=t.name)},E.prototype.parserCellStyle=function(e,t,o,r){if(null!==e.name&&void 0!==e.name){if(!t.isGlobalStyle)return void this.applyGlobalStyle(e,t);t.name=e.name}null!==e.backColor&&void 0!==e.backColor&&(t.backColor=e.backColor),t.borders=new i,null!==e.borders&&void 0!==e.borders&&this.parserBorder(e.borders,t.borders.all),null!==e.leftBorder&&void 0!==e.leftBorder&&this.parserBorder(e.leftBorder,t.borders.left),null!==e.rightBorder&&void 0!==e.rightBorder&&this.parserBorder(e.rightBorder,t.borders.right),null!==e.topBorder&&void 0!==e.topBorder&&this.parserBorder(e.topBorder,t.borders.top),null!==e.bottomBorder&&void 0!==e.bottomBorder&&this.parserBorder(e.bottomBorder,t.borders.bottom),null!==e.fontName&&void 0!==e.fontName&&(t.fontName=e.fontName),null!==e.fontSize&&void 0!==e.fontSize&&(t.fontSize=e.fontSize),null!==e.fontColor&&void 0!==e.fontColor&&(t.fontColor=e.fontColor),null!==e.italic&&void 0!==e.italic&&(t.italic=e.italic),null!==e.bold&&void 0!==e.bold&&(t.bold=e.bold),null!==e.hAlign&&void 0!==e.hAlign&&(t.hAlign=e.hAlign.toLowerCase()),null!==e.indent&&void 0!==e.indent&&(t.indent=e.indent,"left"!==t.hAlign)&&"right"!==t.hAlign&&(t.hAlign="left"),null!==e.rotation&&void 0!==e.rotation&&(t.rotation=e.rotation),null!==e.vAlign&&void 0!==e.vAlign&&(t.vAlign=e.vAlign.toLowerCase()),null!==e.underline&&void 0!==e.underline&&(t.underline=e.underline),null!==e.strikeThrough&&void 0!==e.strikeThrough&&(t.strikeThrough=e.strikeThrough),null!==e.wrapText&&void 0!==e.wrapText&&(t.wrapText=e.wrapText),null!==e.numberFormat&&void 0!==e.numberFormat?null!==e.type&&void 0!==e.type?t.numberFormat=this.getNumberFormat(e.numberFormat,e.type):t.numberFormat=this.getNumberFormat(e.numberFormat,o):(void 0!==r&&(t.numFmtId=14),t.numberFormat="GENERAL"),t.index=this.processCellStyle(t)},E.prototype.switchNumberFormat=function(e,t){var o=this.getNumberFormat(e,t);if(o!==e){var r=this.mNumFmt.get(e);if(void 0!==r&&(r.formatCode=o,this.mNumFmt.has(o))){for(var i=0,n=this.mCellStyleXfs;i<n.length;i++){var s=n[i];s.numFmtId===r.numFmtId&&(s.numFmtId=this.mNumFmt.get(o).numFmtId)}for(var l=0,a=this.mCellXfs;l<a.length;l++){var h=a[l];h.numFmtId===r.numFmtId&&(h.numFmtId=this.mNumFmt.get(o).numFmtId)}}}},E.prototype.changeNumberFormats=function(e){if("string"==typeof e){var t=new RegExp(this.currency,"g");e=e.replace(t,"[$"+this.currency+"]")}else if("object"==typeof e)for(var o=0;o<e.length;o++)e[o]=e[o].replace(this.currency,"[$"+this.currency+"]");return e},E.prototype.getNumberFormat=function(t,e){var o;switch(e){case"number":try{o=this.intl.getNumberPattern({format:t,currency:this.currency,useGrouping:!0},!0),1<this.currency.length&&(o=this.changeNumberFormats(o))}catch(e){o=t}break;case"datetime":try{o=this.intl.getDatePattern({skeleton:t,type:"dateTime"},!0)}catch(e){try{o=this.intl.getDatePattern({format:t,type:"dateTime"},!0)}catch(e){o=t}}break;case"date":try{o=this.intl.getDatePattern({skeleton:t,type:"date"},!0)}catch(e){try{o=this.intl.getDatePattern({format:t,type:"date"},!0)}catch(e){o=t}}break;case"time":try{o=this.intl.getDatePattern({skeleton:t,type:"time"},!0)}catch(e){try{o=this.intl.getDatePattern({format:t,type:"time"},!0)}catch(e){o=t}}break;default:o=t}return o},E.prototype.parserBorder=function(e,t){null!==e.color&&void 0!==e.color?t.color=e.color:t.color="#000000",null!==e.lineStyle&&void 0!==e.lineStyle?t.lineStyle=e.lineStyle:t.lineStyle="thin"},E.prototype.processCellStyle=function(e){var t;return!e.isGlobalStyle&&(t=this.compareStyle(e)).result?t.index:(this.processNumFormatId(e),this.mStyles.push(e),this.mStyles.length)},E.prototype.processNumFormatId=function(e){var t;"GENERAL"===e.numberFormat||this.mNumFmt.has(e.numberFormat)||(t=this.mNumFmt.size+164,this.mNumFmt.set(e.numberFormat,new c(t,e.numberFormat)))},E.prototype.isNewFont=function(e){for(var t=!1,o=0,r=0,i=this.mFonts;r<i.length;r++){var n=i[r],s=(o++,void 0);if(void 0!==e.fontColor&&(s="FF"+e.fontColor.replace("#","")),t=n.color===s&&n.b===e.bold&&n.i===e.italic&&n.u===e.underline&&n.strike===e.strikeThrough&&n.name===e.fontName&&n.sz===e.fontSize)break}return{index:o-=1,result:t}},E.prototype.isNewBorder=function(e){var t=new h;return this.isAllBorder(e.borders)?t.borders.all.color===e.borders.all.color&&t.borders.all.lineStyle===e.borders.all.lineStyle:t.borders.left.color===e.borders.left.color&&t.borders.left.lineStyle===e.borders.left.lineStyle&&t.borders.right.color===e.borders.right.color&&t.borders.right.lineStyle===e.borders.right.lineStyle&&t.borders.top.color===e.borders.top.color&&t.borders.top.lineStyle===e.borders.top.lineStyle&&t.borders.bottom.color===e.borders.bottom.color&&t.borders.bottom.lineStyle===e.borders.bottom.lineStyle},E.prototype.isAllBorder=function(e){var t=new h;return t.borders.all.color!==e.all.color&&t.borders.all.lineStyle!==e.all.lineStyle},E.prototype.compareStyle=function(e){for(var t=!0,o=0,r=0,i=this.mStyles;r<i.length;r++){var n=i[r];if(t=!n.isGlobalStyle&&n.backColor===e.backColor&&n.bold===e.bold&&n.numFmtId===e.numFmtId&&n.numberFormat===e.numberFormat&&n.type===e.type&&n.fontColor===e.fontColor&&n.fontName===e.fontName&&n.fontSize===e.fontSize&&n.hAlign===e.hAlign&&n.italic===e.italic&&n.underline===e.underline&&n.strikeThrough===e.strikeThrough&&n.vAlign===e.vAlign&&n.indent===e.indent&&n.rotation===e.rotation&&n.wrapText===e.wrapText&&n.borders.all.color===e.borders.all.color&&n.borders.all.lineStyle===e.borders.all.lineStyle&&n.borders.left.color===e.borders.left.color&&n.borders.left.lineStyle===e.borders.left.lineStyle&&n.borders.right.color===e.borders.right.color&&n.borders.right.lineStyle===e.borders.right.lineStyle&&n.borders.top.color===e.borders.top.color&&n.borders.top.lineStyle===e.borders.top.lineStyle&&n.borders.bottom.color===e.borders.bottom.color&&n.borders.bottom.lineStyle===e.borders.bottom.lineStyle){o=n.index;break}}return{index:o,result:t}},E.prototype.contains=function(e,t){t=e.indexOf(t);return-1<t&&t<e.length},E.prototype.getCellValueType=function(e){return e instanceof Date?"datetime":"boolean"==typeof e?"boolean":"number"==typeof e?"number":"string"},E.prototype.parseCellType=function(e){var t=e.type,o=e.value;switch(t){case"datetime":o=this.toOADate(o);void 0!==e.cellStyle&&void 0!==e.cellStyle.name&&this.globalStyles.has(e.cellStyle.name)&&(i=this.globalStyles.get(e.cellStyle.name),this.switchNumberFormat(i.format,i.type)),r="n";break;case"boolean":o=o?1:0,r="b";break;case"number":r="n",void 0!==e.cellStyle&&void 0!==e.cellStyle.name&&this.globalStyles.has(e.cellStyle.name)&&this.switchNumberFormat(this.globalStyles.get(e.cellStyle.name).format,"number");break;case"string":this.sharedStringCount++;var r="s",i=this.processCellValue(o,e);this.contains(this.sharedString,i)||this.sharedString.push(i),o=this.sharedString.indexOf(i)}e.saveType=r,e.value=o},E.prototype.parserImages=function(e,t){var o=e.length;t.images=[];for(var r=0;r<o;r++){var i=this.parserImage(e[r]);t.images.push(i)}},E.prototype.parseFilters=function(e,t){if(t.autoFilters=new X,null===e.row||void 0===e.row)throw new Error("Argument Null Exception: row null or empty");if(t.autoFilters.row=e.row,null===e.lastRow||void 0===e.lastRow)throw new Error("Argument Null Exception: lastRow cannot be null or empty");if(t.autoFilters.lastRow=e.lastRow,null===e.column||void 0===e.column)throw new Error("Argument Null Exception: column cannot be null or empty");if(t.autoFilters.column=e.column,null===e.lastColumn||void 0===e.row)throw new Error("Argument Null Exception: lastColumn cannot be null or empty");t.autoFilters.lastColumn=e.lastColumn},E.prototype.parserImage=function(e){var t=new G;return null!==e.image&&void 0!==e.image&&(t.image=e.image),null!==e.row&&void 0!==e.row&&(t.row=e.row),null!==e.column&&void 0!==e.column&&(t.column=e.column),null!==e.lastRow&&void 0!==e.lastRow&&(t.lastRow=e.lastRow),null!==e.lastColumn&&void 0!==e.lastColumn&&(t.lastColumn=e.lastColumn),null!==e.width&&void 0!==e.width&&(t.width=e.width),null!==e.height&&void 0!==e.height&&(t.height=e.height),null!==e.horizontalFlip&&void 0!==e.horizontalFlip&&(t.horizontalFlip=e.horizontalFlip),null!==e.verticalFlip&&void 0!==e.verticalFlip&&(t.verticalFlip=e.verticalFlip),null!==e.rotation&&void 0!==e.rotation&&(t.rotation=e.rotation),t},E.prototype.saveAsBlob=function(e,r){var i=this;return"text/csv"!==e?new Promise(function(o,e){i.saveInternal(),i.mArchive.saveAsBlob().then(function(e){var t={};t.blobData=new Blob([e],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),o(t)})}):new Promise(function(e,t){var o={};o.blobData=i.csvHelper.saveAsBlob(r),e(o)})},E.prototype.save=function(e,t){var o=this;if(null==e||""===e)throw new Error("Argument Null Exception: fileName cannot be null or empty");var r=e.match(".xlsx$"),i=e.match(".csv$");if(null!==r&&r[0]==="."+this.mSaveType)this.saveInternal(),this.mArchive.save(e).then(function(){o.mArchive.destroy()});else{if(null===i||i[0]!=="."+this.mSaveType)throw Error("Save type and file extension is different.");this.csvHelper.save(e)}},E.prototype.saveInternal=function(){this.saveWorkbook(),this.saveWorksheets(),this.saveSharedString(),this.saveStyles(),this.saveApp(this.builtInProperties),this.saveCore(this.builtInProperties),this.saveContentType(),this.saveTopLevelRelation(),this.saveWorkbookRelation()},E.prototype.saveWorkbook=function(){for(var o,e='<?xml version="1.0" encoding="utf-8"?><workbook xmlns:r = "http://schemas.openxmlformats.org/officeDocument/2006/relationships" xmlns= "http://schemas.openxmlformats.org/spreadsheetml/2006/main"><workbookPr codeName="ThisWorkbook" defaultThemeVersion= "153222"/><bookViews><workbookView activeTab="0"/></bookViews>',t="<sheets>",r=this.worksheets.length,i=0;i<r;i++){var n=this.worksheets[i].name;t+='<sheet name="'+(n=(n=(n=(n=n.replace("&","&amp;")).replace("<","&lt;")).replace(">","&gt;")).replace('"',"&quot;"))+'" sheetId="'+(i+1).toString()+'" r:id ="rId'+(i+1).toString()+'" />'}e+=t+="</sheets>",0<this.printTitles.size&&(o="<definedNames>",this.printTitles.forEach(function(e,t){o+='<definedName name="_xlnm.Print_Titles" localSheetId="'+t+'">'+e+"</definedName>"}),e+=o+="</definedNames>"),this.addToArchive(e+"</workbook>","xl/workbook.xml")},E.prototype.saveWorksheets=function(){for(var e=this.worksheets.length,t=0;t<e;t++)this.saveWorksheet(this.worksheets[t],t)},E.prototype.saveWorksheet=function(e,t){var o=new B,r='<?xml version="1.0" encoding="utf-8" standalone="yes"?><worksheet xmlns:r="http://schemas.openxmlformats.org/officeDocument/2006/relationships" xmlns:x14="http://schemas.microsoft.com/office/spreadsheetml/2009/9/main" xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main">';if(e.isSummaryRowBelow?r+="<sheetPr />":r+='<sheetPr><outlinePr summaryBelow="0" ></outlinePr></sheetPr>',r+=this.saveSheetView(e),void 0!==e.columns){for(var i="<cols>",n=0,s=e.columns;n<s.length;n++){var l=s[n];void 0!==l.width?i+='<col min="'+l.index+'" max="'+l.index+'" width="'+this.pixelsToColumnWidth(l.width)+'" customWidth="1" />':i+='<col min="'+l.index+'" max="'+l.index+'" width="8.43" customWidth="1" />'}r+=i+"</cols>"}if(o.append(r+="<sheetData>"),r="",void 0!==e.rows)for(var a=0,h=e.rows;a<h.length;a++){var d=h[a],m='<row r="'+d.index+'" ';w.isNullOrUndefined(d.spans)||(m+='spans="'+d.spans+'" '),void 0!==d.height&&(m+='ht="'+this.pixelsToRowHeight(d.height)+'" customHeight="1" '),void 0!==d.grouping&&(d.grouping.isHidden&&(m+='hidden="1" '),void 0!==d.grouping.outlineLevel&&(m+='outlineLevel="'+d.grouping.outlineLevel+'" '),d.grouping.isCollapsed)&&(m+='collapsed="1" '),m+=">";for(var p=0,c=d.cells;p<c.length;p++){var u=c[p];void 0===u||void 0===u.value&&void 0===u.cellStyle||(m+='<c r="'+u.refName+'" ',void 0!==u.saveType&&(m+='t="'+u.saveType+'" '),void 0!==u.styleIndex&&(m+='s="'+u.styleIndex+'" '),m+=" >",void 0!==u.formula&&(m+="<f>"+u.formula+"</f>"),void 0!==u.value?m+="<v>"+u.value+"</v></c>":m+="</c>")}m+="</row>",o.append(m)}if(r+="</sheetData>",null!==e.autoFilters&&void 0!==e.autoFilters&&(r+='<autoFilter ref="'+this.getCellName(e.autoFilters.row,e.autoFilters.column)+":"+this.getCellName(e.autoFilters.lastRow,e.autoFilters.lastColumn)+'"/>'),0<e.mergeCells.length){r+='<mergeCells count="'+e.mergeCells.length+'">';for(var f=0,g=e.mergeCells;f<g.length;f++)r+='<mergeCell ref="'+g[f].ref+'" />';r+="</mergeCells>"}if(0<e.hyperLinks.length){r+="<hyperlinks>";for(var v=0,y=e.hyperLinks;v<y.length;v++){var x=y[v];r+='<hyperlink ref="'+x.ref+'" r:id="rId'+x.rId+'" />'}r+="</hyperlinks>"}r+='<pageMargins left="0.75" right="0.75" top="1" bottom="1" header="0.5" footer="0.5" /><headerFooter scaleWithDoc="1" alignWithMargins="0" differentFirst="0" differentOddEven="0" />',null!=e.images&&0<e.images.length&&(this.drawingCount++,this.saveDrawings(e,e.index),r+='<drawing r:id="rId'+(e.hyperLinks.length+1)+'"/>'),this.addToArchive(this.saveSheetRelations(e),"xl/worksheets/_rels/sheet"+e.index+".xml.rels"),o.append(r+"</worksheet>"),this.addToArchive(o.getBlob(),"xl/worksheets/sheet"+(t+1)+".xml")},E.prototype.saveDrawings=function(e,t){var o=new B,r='<xdr:wsDr xmlns:xdr="http://schemas.openxmlformats.org/drawingml/2006/spreadsheetDrawing" xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main">';if(void 0!==e.images){for(var i=0,n=0,s=e.images;n<s.length;n++){var l=s[n],l=(void 0!==l.height&&void 0!==l.width?(this.updatelastRowOffset(e,l),this.updatelastColumnOffSet(e,l),--l.lastRow,--l.lastColumn):void 0!==l.lastRow&&void 0!==l.lastColumn&&(l.lastRowOffset=0,l.lastColOffset=0),i++,r=(r=(r=(r=(r=(r=(r=(r=(r=(r=(r=(r=(r=(r=(r=r+'<xdr:twoCellAnchor editAs="oneCell">'+"<xdr:from><xdr:col>")+(l.column-1)+"</xdr:col><xdr:colOff>")+0+"</xdr:colOff><xdr:row>")+(l.row-1))+"</xdr:row><xdr:rowOff>"+0)+"</xdr:rowOff></xdr:from>"+"<xdr:to><xdr:col>")+l.lastColumn+"</xdr:col><xdr:colOff>")+l.lastColOffset+"</xdr:colOff><xdr:row>")+l.lastRow+"</xdr:row><xdr:rowOff>")+l.lastRowOffset)+"</xdr:rowOff></xdr:to>"+"<xdr:pic>")+"<xdr:nvPicPr>"+('<xdr:cNvPr id="'+i+'" name="Picture '+i+'"> </xdr:cNvPr>'))+'<xdr:cNvPicPr><a:picLocks noChangeAspect="1"/></xdr:cNvPicPr> </xdr:nvPicPr>'+"<xdr:blipFill>")+('<a:blip xmlns:r="http://schemas.openxmlformats.org/officeDocument/2006/relationships" r:embed="rId'+i+'" cstate="print">')+"</a:blip><a:stretch><a:fillRect /></a:stretch></xdr:blipFill>")+"<xdr:spPr>"+"<a:xfrm",null!=l.rotation&&l.rotation<=3600&&-3600<=l.rotation&&(r+=' rot="'+6e4*l.rotation+'"'),null!=l.verticalFlip&&0!=l.verticalFlip&&(r+=' flipV="1"'),null!=l.horizontalFlip&&0!=l.horizontalFlip&&(r+=' flipH="1"'),r=(r+="/>")+'<a:prstGeom prst="rect"><a:avLst /></a:prstGeom></xdr:spPr>'+"</xdr:pic><xdr:clientData /></xdr:twoCellAnchor>",this.convertBase64toImage(l.image));this.imageCount+=1,this.addToArchive(l,"xl/media/image"+this.imageCount+".png")}o.append(r),o.append("</xdr:wsDr>"),this.saveDrawingRelations(e),this.addToArchive(o.getBlob(),"xl/drawings/drawing"+this.drawingCount+".xml")}},E.prototype.updatelastRowOffset=function(e,t){for(var o=t.height,r=t.row,i=0;0<=o;){var n=0,s=(n=void 0!==e.rows&&void 0!==e.rows[r-1]?this.convertToPixels(void 0===e.rows[r-1].height?15:e.rows[r-1].height):this.convertToPixels(15))-i*n/256;if(o<s){t.lastRow=r,t.lastRowOffset=i+256*o/n;n=0,n=void 0!==e.rows&&void 0!==e.rows[r-1]?this.convertToPixels(void 0===e.rows[r-1].height?15:e.rows[r-1].height):this.convertToPixels(15);t.lastRowOffset=n*t.lastRowOffset/256,t.lastRowOffset=Math.round(t.lastRowOffset/this.unitsProportions[7]);break}o-=s,r++,i=0}},E.prototype.updatelastColumnOffSet=function(e,t){for(var o=t.width,r=t.column,i=0;0<=o;){var n=0,s=(n=void 0!==e.columns&&void 0!==e.columns[r-1]?this.ColumnWidthToPixels(void 0===e.columns[r-1].width?8.43:e.columns[r-1].width):this.ColumnWidthToPixels(8.43))-i*n/1024;if(o<s){t.lastColumn=r,t.lastColOffset=i+1024*o/n;n=0,n=void 0!==e.columns&&void 0!==e.columns[r-1]?this.ColumnWidthToPixels(void 0===e.columns[r-1].width?8.43:e.columns[r-1].width):this.ColumnWidthToPixels(8.43);t.lastColOffset=n*t.lastColOffset/1024,t.lastColOffset=Math.round(t.lastColOffset/this.unitsProportions[7]);break}o-=s,r++,i=0}},E.prototype.convertToPixels=function(e){return e*this.unitsProportions[6]},E.prototype.convertBase64toImage=function(e){for(var t=window.atob(e),e=new ArrayBuffer(t.length),o=new Uint8Array(e),r=0;r<t.length;r++)o[r]=t.charCodeAt(r);return new Blob([o],{type:"image/png"})},E.prototype.saveDrawingRelations=function(e){for(var t='<?xml version="1.0" encoding="utf-8" standalone="yes"?><Relationships xmlns="http://schemas.openxmlformats.org/package/2006/relationships">',o=e.images.length,r=this.imageCount-e.images.length,i=1;i<=o;i++)t+='<Relationship Id="rId'+i+'" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/image" Target="../media/image'+ ++r+'.png" />';this.addToArchive(t+"</Relationships>","xl/drawings/_rels/drawing"+this.drawingCount+".xml.rels")},E.prototype.pixelsToColumnWidth=function(e){e=12<e?this.trunc((e-5)/7*100+.5)/100:e/12;return 1<e?(7*e+5)/7*256/256:12*e/7*256/256},E.prototype.ColumnWidthToPixels=function(e){return this.trunc((256*(1<e?(7*e+5)/7*256/256:12*e/7*256/256)+this.trunc(128/7))/256*7)},E.prototype.trunc=function(e){var t=e-e%1;return 0==t&&(e<0||0===e&&1/e!=1/0)?-0:t},E.prototype.pixelsToRowHeight=function(e){return e*this.unitsProportions[5]/this.unitsProportions[6]},E.prototype.saveSheetRelations=function(e){for(var t='<?xml version="1.0" encoding="UTF-8" standalone="yes"?><Relationships xmlns="http://schemas.openxmlformats.org/package/2006/relationships">',o=0,r=e.hyperLinks;o<r.length;o++){var i=r[o];t+='<Relationship Id="rId'+i.rId+'" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink" Target="'+this.processString(i.target)+'" TargetMode="External" />'}return null!=e.images&&0<e.images.length&&(t+='<Relationship Id="rId'+(e.hyperLinks.length+1)+'" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing" Target="../drawings/drawing'+this.drawingCount+'.xml" />'),t+="</Relationships>"},E.prototype.saveSheetView=function(e){var t='<sheetViews><sheetView workbookViewId="0" ';return!0===e.enableRtl&&(t+='rightToLeft="1"'),!1===e.showGridLines?t+='showGridLines="0" >':t+=">",void 0!==e.freezePanes&&(t+='<pane state="frozen" topLeftCell="'+e.freezePanes.leftCell+'" ',0!==e.freezePanes.row&&(t+='ySplit="'+e.freezePanes.row+'" '),0!==e.freezePanes.column&&(t+='xSplit="'+e.freezePanes.column+'" '),t+="/>"),t+="</sheetView></sheetViews > "},E.prototype.saveSharedString=function(){var e=this.sharedString.length;if(0<e){for(var t='<?xml version="1.0" encoding="utf-8"?><sst uniqueCount="'+e+'" count="'+this.sharedStringCount+'" xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main">',o="",r=0;r<e;r++)o=0!==this.sharedString[r].indexOf("<r>")?(o+="<si><t>")+this.processString(this.sharedString[r])+"</t></si>":(o+="<si>")+this.sharedString[r]+"</si>";this.addToArchive(t+(o+="</sst>"),"xl/sharedStrings.xml")}},E.prototype.processString=function(e){if("string"==typeof e)-1!==(e=-1!==(e=-1!==(e=-1!==e.indexOf("&")?e.replace(/&/g,"&amp;"):e).indexOf("<")?e.replace(/</g,"&lt;"):e).indexOf(">")?e.replace(/>/g,"&gt;"):e).indexOf("\v")&&(e=e.replace(/\v/g,"_x000B_"));else if("object"==typeof e)for(var t=0;t<e.length;t++)-1!==e[t].indexOf("&")&&(e[t]=e[t].replace(/&/g,"&amp;")),-1!==e[t].indexOf("<")&&(e[t]=e[t].replace(/</g,"&lt;")),-1!==e[t].indexOf(">")&&(e[t]=e[t].replace(/>/g,"&gt;")),-1!==e[t].indexOf("\v")&&(e[t]=e[t].replace(/\v/g,"_x000B_"));return e},E.prototype.saveStyles=function(){this.updateCellXfsStyleXfs();var e='<?xml version="1.0" encoding="utf-8"?><styleSheet xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" mc:Ignorable="x14ac" xmlns:x14ac="http://schemas.microsoft.com/office/spreadsheetml/2009/9/ac" xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main">',e=(e=(e=(e=(e=(e=(e+=this.saveNumberFormats())+this.saveFonts())+this.saveFills())+this.saveBorders())+this.saveCellStyleXfs())+this.saveCellXfs())+this.saveCellStyles();this.addToArchive(e+"</styleSheet>","xl/styles.xml")},E.prototype.updateCellXfsStyleXfs=function(){for(var e=0,t=this.mStyles;e<t.length;e++){var o,r=t[e],i=void 0,n=(r.isGlobalStyle?(i=new m).xfId=r.index-1:(i=new s).xfId=0,this.isNewFont(r));n.result?i.fontId=n.index:((n=new d).b=r.bold,n.i=r.italic,n.name=r.fontName,n.sz=r.fontSize,n.u=r.underline,n.strike=r.strikeThrough,n.color="FF"+r.fontColor.replace("#",""),this.mFonts.push(n),i.fontId=this.mFonts.length-1),"none"!==r.backColor?(n="FF"+r.backColor.replace("#",""),this.mFills.has(n)?o=this.mFills.get(n):(o=this.mFills.size+2,this.mFills.set(n,o)),i.fillId=o):i.fillId=0,this.isNewBorder(r)?i.borderId=0:(this.mBorders.push(r.borders),i.borderId=this.mBorders.length),"GENERAL"!==r.numberFormat?this.mNumFmt.has(r.numberFormat)?(n=this.mNumFmt.get(r.numberFormat),i.numFmtId=n.numFmtId):(n=this.mNumFmt.size+164,this.mNumFmt.set(r.numberFormat,new c(n,r.numberFormat)),i.numFmtId=n):"GENERAL"===r.numberFormat&&14===r.numFmtId?i.numFmtId=14:i.numFmtId=0,r.isGlobalStyle||(i.applyAlignment=1),i.alignment=new l,i.alignment.indent=r.indent,i.alignment.horizontal=r.hAlign,i.alignment.vertical=r.vAlign,i.alignment.wrapText=r.wrapText?1:0,i.alignment.rotation=r.rotation,r.isGlobalStyle&&this.mCellStyleXfs.push(i),this.mCellXfs.push(i)}},E.prototype.saveNumberFormats=function(){var o;return 1<=this.mNumFmt.size?(o='<numFmts count="'+this.mNumFmt.size+'">',this.mNumFmt.forEach(function(e,t){o+='<numFmt numFmtId="'+e.numFmtId+'" formatCode="'+e.formatCode.replace(/"/g,"&quot;")+'" />'}),o+="</numFmts>"):""},E.prototype.saveFonts=function(){var e='<fonts count="'+this.mFonts.length+'">';if(1<=this.mFonts.length)for(var t=0,o=this.mFonts;t<o.length;t++){var r=o[t];e+="<font>",r.b&&(e+="<b />"),r.i&&(e+="<i />"),r.u&&(e+="<u />"),r.strike&&(e+="<strike />"),e=(e=(e+='<sz val="'+r.sz+'" />')+('<color rgb="'+r.color+'" />'))+('<name val="'+r.name+'" /></font>')}return e+"</fonts>"},E.prototype.saveFills=function(){var o='<fills count="'+(this.mFills.size+2)+'"><fill><patternFill patternType="none"></patternFill></fill><fill><patternFill patternType="gray125"></patternFill></fill>';return 1<=this.mFills.size&&this.mFills.forEach(function(e,t){o+='<fill><patternFill patternType="solid"><fgColor rgb="'+t+'" /><bgColor rgb="FFFFFFFF" /></patternFill></fill>'}),o+"</fills>"},E.prototype.saveBorders=function(){var e='<borders count="'+(this.mBorders.length+1)+'"><border><left /><right /><top /><bottom /><diagonal /></border>';if(1<=this.mBorders.length)for(var t=0,o=this.mBorders;t<o.length;t++){var r,i,n=o[t];this.isAllBorder(n)?(r=n.all.color.replace("#",""),e+='<border><left style="'+(i=n.all.lineStyle)+'"><color rgb="FF'+r+'" /></left><right style="'+i+'"><color rgb="FF'+r+'" /></right><top style="'+i+'"><color rgb="FF'+r+'" /></top><bottom style="'+i+'"><color rgb="FF'+r+'" /></bottom></border>'):e+='<border><left style="'+n.left.lineStyle+'"><color rgb="FF'+n.left.color.replace("#","")+'" /></left><right style="'+n.right.lineStyle+'"><color rgb="FF'+n.right.color.replace("#","")+'" /></right><top style="'+n.top.lineStyle+'"><color rgb="FF'+n.top.color.replace("#","")+'" /></top><bottom style="'+n.bottom.lineStyle+'"><color rgb="FF'+n.bottom.color.replace("#","")+'" /></bottom></border>'}return e+"</borders>"},E.prototype.saveCellStyles=function(){var o=this,r='<cellStyles  count="'+this.cellStyles.size+'">';return this.cellStyles.forEach(function(e,t){r+='<cellStyle name="'+t+'" xfId="'+o.cellStyles.get(t).xfId+'"',"Normal"===t&&(r+=' builtinId="0"'),r+=" />"}),r+="</cellStyles>"},E.prototype.saveCellStyleXfs=function(){var e='<cellStyleXfs count="'+(this.mCellStyleXfs.length+1)+'"><xf numFmtId="0" fontId="0" fillId="0" borderId="0" />';if(1<=this.mCellStyleXfs.length)for(var t=0,o=this.mCellStyleXfs;t<o.length;t++){var r=o[t];e+='<xf numFmtId="'+r.numFmtId+'" fontId="'+r.fontId+'" fillId="'+r.fillId+'" borderId="'+r.borderId+'" ',void 0!==r.alignment?e+=">"+this.saveAlignment(r)+"</xf>":e+=" />"}return e+"</cellStyleXfs>"},E.prototype.saveCellXfs=function(){var e='<cellXfs count="'+(this.mCellXfs.length+1)+'"><xf numFmtId="0" fontId="0" fillId="0" borderId="0" xfId="0" />';if(1<=this.mCellXfs.length)for(var t=0,o=this.mCellXfs;t<o.length;t++){var r=o[t];e+='<xf numFmtId="'+r.numFmtId+'" fontId="'+r.fontId+'" fillId="'+r.fillId+'" borderId="'+r.borderId+'" xfId="'+r.xfId+'" ',1===r.applyAlignment&&(e+='applyAlignment="1"'),e+=">"+this.saveAlignment(r)+"</xf>"}return e+"</cellXfs>"},E.prototype.saveAlignment=function(e){var t="<alignment ";return void 0!==e.alignment.horizontal&&(t+='horizontal="'+e.alignment.horizontal+'" '),void 0!==e.alignment.indent&&0!==e.alignment.indent?t+='indent="'+e.alignment.indent+'" ':void 0!==e.alignment.rotation&&0!==e.alignment.rotation&&(t+='textRotation="'+e.alignment.rotation+'" '),void 0!==e.alignment.vertical&&(t+='vertical="'+e.alignment.vertical+'" '),t+='wrapText="'+e.alignment.wrapText+'" />'},E.prototype.saveApp=function(e){var t='<?xml version="1.0" encoding="utf-8" standalone="yes"?><Properties xmlns="http://schemas.openxmlformats.org/officeDocument/2006/extended-properties"><Application>Essential XlsIO</Application>';void 0!==e&&(void 0!==e.manager&&(t+="<Manager>"+e.manager+"</Manager>"),void 0!==e.company)&&(t+="<Company>"+e.company+"</Company>"),this.addToArchive(t+"</Properties>","docProps/app.xml")},E.prototype.saveCore=function(e){var t=new Date,o='<?xml version="1.0" encoding="utf-8" standalone="yes"?><cp:coreProperties xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:dcterms="http://purl.org/dc/terms/" xmlns:dcmitype="http://purl.org/dc/dcmitype/" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:cp="http://schemas.openxmlformats.org/package/2006/metadata/core-properties">';void 0!==this.builtInProperties?(void 0!==e.author&&(o+="<dc:creator>"+e.author+"</dc:creator>"),void 0!==e.subject&&(o+="<dc:subject>"+e.subject+"</dc:subject>"),void 0!==e.category&&(o+="<cp:category>"+e.category+"</cp:category>"),void 0!==e.comments&&(o+="<dc:description>"+e.comments+"</dc:description>"),void 0!==e.title&&(o+="<dc:title>"+e.title+"</dc:title>"),void 0!==e.tags&&(o+="<cp:keywords>"+e.tags+"</cp:keywords>"),void 0!==e.status&&(o+="<cp:contentStatus>"+e.status+"</cp:contentStatus>"),void 0!==e.createdDate?o+='<dcterms:created xsi:type="dcterms:W3CDTF">'+e.createdDate.toISOString()+"</dcterms:created>":o+='<dcterms:created xsi:type="dcterms:W3CDTF">'+t.toISOString()+"</dcterms:created>",void 0!==e.modifiedDate?o+='<dcterms:modified xsi:type="dcterms:W3CDTF">'+e.modifiedDate.toISOString()+"</dcterms:modified>":o+='<dcterms:modified xsi:type="dcterms:W3CDTF">'+t.toISOString()+"</dcterms:modified>"):o=(o+='<dcterms:created xsi:type="dcterms:W3CDTF">'+t.toISOString()+"</dcterms:created>")+'<dcterms:modified xsi:type="dcterms:W3CDTF">'+t.toISOString()+"</dcterms:modified>",this.addToArchive(o+="</cp:coreProperties>","docProps/core.xml")},E.prototype.saveTopLevelRelation=function(){this.addToArchive('<?xml version="1.0" encoding="utf-8" standalone="yes"?><Relationships xmlns="http://schemas.openxmlformats.org/package/2006/relationships"><Relationship Id="rId1" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument" Target="xl/workbook.xml" /><Relationship Id="rId2" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties" Target="docProps/app.xml" /><Relationship Id="rId3" Type="http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties" Target="docProps/core.xml" /></Relationships>',"_rels/.rels")},E.prototype.saveWorkbookRelation=function(){for(var e='<?xml version="1.0" encoding="utf-8" standalone="yes"?><Relationships xmlns="http://schemas.openxmlformats.org/package/2006/relationships">',t=this.worksheets.length,o=0,r=0;r<t;r++,o++)e+='<Relationship Id="rId'+(r+1).toString()+'" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet" Target="worksheets/sheet'+(r+1).toString()+'.xml" />';e+='<Relationship Id="rId'+(++o).toString()+'" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles" Target="styles.xml" />',0<this.sharedStringCount&&(e+='<Relationship Id="rId'+(++o).toString()+'" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings" Target="sharedStrings.xml" />'),this.addToArchive(e+"</Relationships>","xl/_rels/workbook.xml.rels")},E.prototype.saveContentType=function(){for(var e='<?xml version="1.0" encoding="utf-8" standalone="yes"?><Types xmlns="http://schemas.openxmlformats.org/package/2006/content-types"><Default Extension="xml" ContentType="application/xml" /><Default Extension="rels" ContentType="application/vnd.openxmlformats-package.relationships+xml" /><Override PartName="/xl/styles.xml" ContentType="application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml" /><Override PartName="/xl/workbook.xml" ContentType="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml" /><Override PartName="/docProps/app.xml" ContentType="application/vnd.openxmlformats-officedocument.extended-properties+xml" /><Override PartName="/docProps/core.xml" ContentType="application/vnd.openxmlformats-package.core-properties+xml" />',t="",o=this.worksheets.length,r=0,i=0;i<o;i++)t+='<Override PartName="/xl/worksheets/sheet'+(i+1).toString()+'.xml" ContentType="application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml" />',null!=this.worksheets[i].images&&0<this.worksheets[i].images.length&&(t+='<Override PartName="/xl/drawings/drawing'+(++r).toString()+'.xml" ContentType="application/vnd.openxmlformats-officedocument.drawing+xml" />');0<this.imageCount&&(t+='<Default Extension="png" ContentType="image/png" />'),0<this.sharedStringCount&&(e+='<Override PartName="/xl/sharedStrings.xml" ContentType="application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml" />'),this.addToArchive(e+t+"</Types>","[Content_Types].xml")},E.prototype.addToArchive=function(e,t){var o;o="string"==typeof e?(o=new Blob([e],{type:"text/plain"}),new a.ZipArchiveItem(o,t)):new a.ZipArchiveItem(e,t),this.mArchive.addItem(o)},E.prototype.processMergeCells=function(e,t,o){var r,i,n;return 0===e.rowSpan&&0===e.colSpan||((r=new P).x=e.index,r.width=e.colSpan,r.y=t,r.height=e.rowSpan,i=this.getCellName(r.y,r.x),n=this.getCellName(t+r.height,e.index+r.width),r.ref=i+":"+n,o.add(r),i={x:r.x,y:r.y},n={x:e.index+r.width,y:t+r.height},this.updatedMergedCellStyles(i,n,e)),o},E.prototype.updatedMergedCellStyles=function(e,t,o){for(var r=e.x;r<=t.x;r++)for(var i=e.y;i<=t.y;i++)this.mergedCellsStyle.set(this.getCellName(i,r),{x:r,y:i,styleIndex:o.styleIndex})},E.prototype.dateToTicks=function(e,t,o){var r;if(1<=e&&e<=9999&&1<=t&&t<=12)return 864e9*(365*(r=e-1)+(r/4|0)-(r/100|0)+(r/400|0)+(this.isLeapYear(e)?[0,31,60,91,121,152,182,213,244,274,305,335,366]:[0,31,59,90,120,151,181,212,243,273,304,334,365])[t-1]+o-1);throw new Error("Not a valid date")},E.prototype.timeToTicks=function(e,t,o){if(0<=e&&e<24&&0<=t&&t<60&&0<=o&&o<60)return 1e4*(3600*e+60*t+o)*1e3;throw new Error("Not valid time")},E.prototype.isLeapYear=function(e){return e%4==0&&(e%100!=0||e%400==0)},E.prototype.toOADate=function(e){if(0===(e=this.dateToTicks(e.getFullYear(),e.getMonth()+1,e.getDate())+this.timeToTicks(e.getHours(),e.getMinutes(),e.getSeconds())))return 0;if(e<31241376e9)throw new Error("Arg_OleAutDateInvalid");return(e-599264352e9)/1e4/864e5},E);function E(e,t,o,r,i){if(this.sharedStringCount=0,this.unitsProportions=[1.28,.32,96,96/25.4,96/2.54,1,96/72,96/72/12700],this.hyperlinkStyle={fontColor:"#0000FF",underline:!0},this.culture=void 0!==o?o:"en-US",this.currency=void 0!==r?r:"USD",this.intl=new w.Internationalization(this.culture),"xlsx"===(this.mSaveType=t)){if(this.mArchive=new a.ZipArchive,this.sharedString=[],this.mFonts=[],this.mBorders=[],this.mStyles=[],this.printTitles=new Map,this.cellStyles=new Map,this.mNumFmt=new Map,this.mFills=new Map,this.mStyles.push(new h),this.mFonts.push(new d),this.cellStyles.set("Normal",new p),this.mCellXfs=[],this.mCellStyleXfs=[],this.drawingCount=0,this.imageCount=0,null!==e.styles&&void 0!==e.styles){this.globalStyles=new Map;for(var n=0;n<e.styles.length;n++)if(void 0!==e.styles[n].name){if(this.cellStyles.has(e.styles[n].name))throw Error("Style name "+e.styles[n].name+" is already existed");var s=new h,l=(s.isGlobalStyle=!0,this.parserCellStyle(e.styles[n],s,"none"),new p),s=(l.name=s.name,l.xfId=s.index-1,this.cellStyles.set(l.name,l),{});void 0!==e.styles[n].numberFormat&&(s.format=e.styles[n].numberFormat),void 0!==e.styles[n].type?s.type=e.styles[n].type:s.type="datetime",void 0!==s.format&&this.globalStyles.set(e.styles[n].name,s)}}if(null===e.worksheets||void 0===e.worksheets)throw Error("Worksheet is expected.");this.parserWorksheets(e.worksheets),null!==e.builtInProperties&&void 0!==e.builtInProperties&&(this.builtInProperties=new Y,this.parserBuiltInProperties(e.builtInProperties,this.builtInProperties))}else this.csvHelper=new U(e,i)}var Y=function(){};e.Alignment=l,e.BlobHelper=B,e.Border=t,e.Borders=i,e.BuiltInProperties=Y,e.Cell=u,e.CellStyle=h,e.CellStyleXfs=m,e.CellStyles=p,e.CellXfs=s,e.Cells=f,e.Column=g,e.CsvHelper=U,e.Font=d,e.FreezePane=M,e.Grouping=W,e.HyperLink=R,e.MergeCell=P,e.MergeCells=j,e.NumFmt=c,e.Row=x,e.Rows=b,e.ValueFormatter=V,e.Workbook=H,e.Worksheet=_,e.Worksheets=k,Object.defineProperty(e,"__esModule",{value:!0})});
//# sourceMappingURL=ej2-excel-export.umd.min.js.map
